== Features Introduced in December 2022

Learn what's new on Prisma™ Cloud in December 2022.


=== New Features Introduced in 22.12.1

* <<new-features>>
* <<api-ingestions>>
* <<new-policies>>
* <<policy-updates>>
* <<New Compliance Benchmarks and Updates>>
* <<changes-in-existing-behavior>>
* <<rest-api-updates>>


[#new-features]
=== New Features

[cols="50%a,50%a"]
|===
|FEATURE
|DESCRIPTION


|*Unified Asset Inventory*
//RLP-80994
|A new https://docs.paloaltonetworks.com/content/dam/techdocs/en_US/pdf/prisma/prisma-cloud/prerelease/unified-asset-inventory-documentation-lga.pdf[Unified Asset Inventory] provides a consolidated view of assets discovered by Prisma Cloud. You can review all your assets on Prisma Cloud across multi-cloud deployments—public and private cloud environments. Unified Asset Inventory provides new capabilities to identify and prioritize remediation of security issues detected within your monitored environments. 

In addition to the assets currently available in Prisma Cloud, Unified Asset Inventory also includes new asset types from Prisma Cloud Compute, including hosts, containers, and container images. You can view this data in a tabular format and search and filter down to specific resources or sets of resources based on your selected filters.

image::unified-asset-inventory.png[scale=20]


|===

[#api-ingestions]
=== API Ingestions

[cols="50%a,50%a"]
|===
|SERVICE
|API DETAILS

|*Amazon CodePipeline*

+++<draft-comment>RLP-83378</draft-comment>+++
|*aws-code-pipeline-pipeline*

Additional permissions required:

* screen:[codepipeline:ListPipelines]
* screen:[codepipeline:GetPipeline]
* screen:[codepipeline:ListTagsForResource]

The Security Audit role includes the permissions except screen:[codepipeline:ListTagsForResource].

[NOTE]
====
You must add the permission manually or use CFT template to update the screen:[codepipeline:ListTagsForResource]permission.
====

|*Amazon Forecast*

+++<draft-comment>RLP-81967</draft-comment>+++
|*aws-forecast-predictor*

Additional permissions required:

* screen:[forecast:DescribePredictor]
* screen:[forecast:DescribeAutoPredictor]
* screen:[forecast:ListTagsForResource]
* screen:[forecast:ListPredictors]

[NOTE]
====
You must add the permissions manually or use CFT template to update the permissions.
====

|*Amazon Forecast*

+++<draft-comment>RLP-81962</draft-comment>+++
|*aws-forecast-dataset*

Additional permissions required:

* screen:[forecast:ListDatasets]
* screen:[forecast:DescribeDataset]
* screen:[forecast:ListTagsForResource]

The Security Audit role only includes screen:[forecast:ListDatasets] permission.

[NOTE] 
====
You must add the permissions manually or use CFT template to update the screen:[forecast:DescribeDataset] and screen:[forecast:ListTagsForResource] permissions.
====

|*AWS Glue DataBrew*

+++<draft-comment>RLP-81956</draft-comment>+++
|*aws-glue-data-brew-job*

Additional permissions required:

* screen:[databrew:DescribeJob]
* screen:[databrew:ListJobs]

[NOTE]
====
You must add the permissions manually or use CFT template to update the permissions.
====

|*Azure App Service*

+++<draft-comment>RLP-82865</draft-comment>+++
|*azure-app-service-diagnostic-settings*

Additional permissions required:

* screen:[Microsoft.Web/sites/Read]
* screen:[Microsoft.Insights/DiagnosticSettings/Read]

The Reader role includes the permissions.

|*Azure Compute*

+++<draft-comment>RLP-76197</draft-comment>+++
|*azure-cloudservices-roleinstance-publicip*

Additional permissions required:

* screen:[Microsoft.Compute/cloudServices/read]
* screen:[Microsoft.Compute/cloudServices/roleInstances/read]
* screen:[Microsoft.Compute/virtualMachineScaleSets/virtualMachines/networkInterfaces/ipConfigurations/publicIPAddresses/read]

The Reader role includes the permissions.

|*Azure Data Lake Analytics*

+++<draft-comment>RLP-82856</draft-comment>+++
|*azure-data-lake-analytics-diagnostic-settings*

Additional permissions required:

* screen:[Microsoft.DataLakeAnalytics/accounts/read]
* screen:[Microsoft.Insights/DiagnosticSettings/Read]

The Reader role includes the permissions.

|*Azure Key Vault*

+++<draft-comment>RLP-82852</draft-comment>+++
|*azure-key-vault-diagnostic-settings*

Additional permissions required:

* screen:[Microsoft.KeyVault/vaults/read]
* screen:[Microsoft.Insights/DiagnosticSettings/Read]

The Reader role includes the permissions.

|*Azure Key Vault*

+++<draft-comment>RLP-82109</draft-comment>+++
|*azure-key-vault-privatelinkresource*

Additional permissions required:

* screen:[Microsoft.KeyVault/vaults/read]
* screen:[Microsoft.KeyVault/vaults/privateLinkResources/read]

The Reader role includes the permissions.

|*Azure Logic Apps*

+++<draft-comment>RLP-82867</draft-comment>+++
|*azure-logic-app-workflow-diagnostic-settings*

Additional permissions required:

* screen:[Microsoft.Logic/workflows/read]
* screen:[Microsoft.Insights/DiagnosticSettings/Read]

The Reader role includes the permissions.

|*Azure Recovery Services*

+++<draft-comment>RLP-82866</draft-comment>+++
|*azure-recovery-service-vault-diagnostic-settings*

Additional permissions required:

* screen:[Microsoft.RecoveryServices/Vaults/read]
* screen:[Microsoft.Insights/DiagnosticSettings/Read]

The Reader role includes the permissions.

|*Azure Subscriptions*

+++<draft-comment>RLP-82110</draft-comment>+++
|*azure-subscription-list*

Additional permission required:

screen:[Microsoft.Resources/subscriptions/read]

The Reader role includes the permission.

|*Azure Virtual Network*

+++<draft-comment>RLP-82108</draft-comment>+++
|*azure-network-private-endpoint*

Additional permission required:

screen:[Microsoft.Network/privateEndpoints/read]

The Reader role includes the permission.

|*Google Apigee X*

+++<draft-comment>RLP-83680</draft-comment>+++
|*gcloud-apigee-x-organization-shared-flow*

Additional permissions required:

* screen:[apigee.organizations.list]
* screen:[apigee.sharedflows.list]
* screen:[apigee.sharedflows.get]
* screen:[apigee.deployments.list]

The Viewer role includes the permissions.

|*Google Apigee X*

+++<draft-comment>RLP-83675</draft-comment>+++
|*gcloud-apigee-x-organization-data-collector*

Additional permissions required:

* screen:[apigee.organizations.list]
* screen:[apigee.datacollectors.list]

The Viewer role includes the permissions.


|*Google Apigee X*

+++<draft-comment>RLP-82138</draft-comment>+++
|*gcloud-apigee-x-organization-instance*

Additional permissions required:

* screen:[apigee.instances.list]
* screen:[apigee.instanceattachments.list]
* screen:[apigee.organizations.list]

The Viewer role includes the permissions.

|*Google Apigee X*

+++<draft-comment>RLP-82136</draft-comment>+++
|*gcloud-apigee-x-organization-environment*

Additional permissions required:

* screen:[apigee.organizations.list]
* screen:[apigee.environments.get]
* screen:[apigee.environments.getIamPolicy]
* screen:[apigee.organizations.get]

The Viewer role includes the permissions.

|*Google Apigee X*

+++<draft-comment>RLP-82083</draft-comment>+++
|*gcloud-apigee-x-organization*

Additional permissions required:

* screen:[apigee.organizations.list]
* screen:[apigee.organizations.get]

The Viewer role includes the permissions.

|*Google Dataplex*

+++<draft-comment>RLP-83678</draft-comment>+++
|*gcloud-dataplex-lake-zone-asset*

Additional permissions required:

* screen:[dataplex.locations.list]
* screen:[dataplex.lakes.list]
* screen:[dataplex.zones.list]
* screen:[dataplex.assets.list]
* screen:[dataplex.assets.getIamPolicy]

The Viewer role includes the permissions.

|*Google Healthcare*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-healthcare-dataset*

Additional permission required:

* screen:[healthcare.datasets.get]

The Viewer role includes the permission.

|*Google Identity and Access Management*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-iam-service-accounts-keys-list*

Additional permission required:

* screen:[iam.serviceAccountKeys.get]

The Viewer role includes the permission.

|*Google Identity and Access Management*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-iam-service-accounts-list*

Additional permission required:

* screen:[iam.serviceAccounts.get]

The Viewer role includes the permission.

|*Google Stackdriver Monitoring*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-monitoring-policies-list*

Additional permission required:

* screen:[monitoring.alertPolicies.get]

The Monitoring Viewer role includes the permission.

|*Google Compute Engine*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-ssl-certificate*

Additional permission required:

* screen:[compute.sslCertificates.get]

The Viewer role includes the permission.

|*Google AI Platform*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-ai-platform-job*

Additional permission required:

* screen:[ml.jobs.get]

The Viewer role includes the permission.

|*Google API Keys*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-api-key*

Additional permission required:

* screen:[apikeys.keys.get]

The API Keys Viewer role includes the permission.

|*Google API Gateway*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-apigateway-gateway*

Additional permission required:

* screen:[apigateway.gateways.get]

The API Gateway Viewer role includes the permission.

|*Google Cloud Armor*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-armor-security-policy*

Additional permission required:

* screen:[compute.securityPolicies.get]

The Viewer role includes the permission.

|*Google Cloud Composer*

+++<draft-comment>RLP-83081</draft-comment>+++
|*gcloud-composer-environment*

Additional permission required:

* screen:[composer.environments.get]

The Viewer role includes the permission.

|tt:[Update] *Google VPC*

+++<draft-comment>RLP-84876</draft-comment>+++
|*gcloud-compute-project-firewall-policy*

Additional permission required:

* screen:[compute.regionfirewallPolicies.list]

The Viewer role includes the permission.

|===

[#new-policies]
=== New Policies

[cols="50%a,50%a"]
|===
|NEW POLICIES
|DESCRIPTION

|*Azure Cosmos DB (PaaS) instance reachable from untrust internet source*

+++<draft-comment>RLP-83885</draft-comment>+++
|Identifies Azure Cosmos DB (PaaS) instances that are internet reachable from untrust internet source. Cosmos DB (PaaS) instances with untrusted access to the internet may enable bad actors to use brute force on a system to gain unauthorised access to the entire network. As a best practice, restrict traffic from untrusted IP addresses and limit the access to known hosts, services, or specific entities.

----
config from network where source.network = UNTRUST_INTERNET and dest.resource.type = 'PaaS' and dest.cloud.type = 'AZURE' and dest.paas.service.type in ('MicrosoftDocumentDBDatabaseAccount')
----


|*Instance affected by Spring Cloud Function SpringShell vulnerability is exposed to network traffic from the internet (CVE-2022-22963)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-84449</draft-comment>+++
|Identifies instances installed with the Spring Cloud Function version that are vulnerable to arbitrary code execution https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22963[CVE-2022-22963], and exposed to network traffic from the internet. As a best practice, upgrade to the latest Spring Cloud Function version and limit internet exposure.

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN (resource where finding.type IN ('Host Vulnerability') AND finding.source IN ('Prisma Cloud') AND finding.name IN ('CVE-2022-22963')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by OpenSSL X.509 email address 4-Byte BOF (Spooky SSL) vulnerability is exposed to network traffic from the internet (CVE-2022-3602)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-83048</draft-comment>+++
|Identifies instances installed with OpenSSL version vulnerable for Spooky SSL: OpenSSL X.509 email address 4-Byte buffer overflow vulnerability https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-3602[CVE-2022-3602] and exposed to network traffic from the internet. As a best practice, upgrade the OpenSSL version to the latest version and limit exposure to the internet.

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-3602') ) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Text4shell RCE vulnerability is exposed to network traffic from the internet (CVE-2022-42889)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-81591</draft-comment>+++
|Identifies instances installed with Apache Commons Text project code version vulnerable for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-42889[CVE-2022-42889] and exposed to network traffic from the internet. As a best practice, upgrade the Apache Commons Text project code version to the latest version and limit exposure to the internet.

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-42889') ) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Apache Log4j JDBC Appender remote code execution vulnerability is exposed to network traffic from the internet (CVE-2021-44832)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies instances installed with Apache Log4j JDBC Appender version vulnerable for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-44832[CVE-2021-44832]. As a best practice, upgrade the Apache Log4j JDBC Appender version to the latest version and limit exposure to the internet.

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2021-44832')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Apache Log4j Thread Context Map remote code execution vulnerability is exposed to network traffic from the internet (CVE-2021-45046)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies instances installed with Apache Log4j Thread Context Map version vulnerable for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-45046[CVE-2021-45046] and exposed to network traffic from the internet. As a best practice, upgrade the Apache Log4j Thread Context Map version to the latest version and limit exposure to the internet.
----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2021-45046')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Apache Log4j denial of service vulnerability is exposed to network traffic from the internet (CVE-2021-45105)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies instances installed with Apache Log4j version vulnerable for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2021-45105[CVE-2021-45105] and exposed to network traffic from the internet. As a best practice, update the Apache Log4j version to the latest version and limit exposure to the internet.  

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2021-45105')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Argo CD vulnerability is exposed to network traffic from the internet (CVE-2022-24348)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies instances installed with Argo CD vulnerability for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-24348[CVE-2022-24348] and exposed to network traffic from the internet. As a best practice, upgrade to the latest version of Argo CD and limit exposure to the internet.  

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-24348')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Linux kernel Dirty Pipe vulnerability is exposed to network traffic from the internet (CVE-2022-0847)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies instances installed with Dirty Pipe vulnerability for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-0847[CVE-2022-0847] and exposed to network traffic from the internet. As a best practice, upgrade to the latest version of Dirty Pipe Linux kernel and limit exposure to the internet.  

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-0847')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Java Psychic Signatures vulnerability is exposed to network traffic from the internet (CVE-2022-21449)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies instances installed with with Oracle Java SE versions vulnerable for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-21449[CVE-2022-21449] and exposed to network traffic from the internet. As a best practice, upgrade to the latest Java Psychic Signatures Oracle Java SE version and limit exposure to the internet.  

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-21449')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Linux kernel container escape vulnerability is exposed to network traffic from the internet (CVE-2022-0185)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies instances installed with with Linux kernel container escape version vulnerable for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-0185[CVE-2022-0185] and exposed to network traffic from the internet. As a best practice, upgrade to the latest Oracle Java SE version and limit exposure to the internet.  

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-0185')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by DCE/RPC remote code execution vulnerability is exposed to network traffic from the internet (CVE-2022-26809)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies instances installed with SMB DCE/RPC remote code execution version vulnerability for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-26809[CVE-2022-26809] and exposed to network traffic from the internet. As a best practice, upgrade to the latest SMB DCE/RPC remote code execution version and limit exposure to the internet.  

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-26809')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|*Instance affected by Samba vfs_fruit module remote code execution vulnerability is exposed to network traffic from the internet (CVE-2021-44142)*

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

+++<draft-comment>RLP-80433</draft-comment>+++
|Identifies network facing instances installed with Samba vfs_fruit module remote code execution version vulnerability for https://cve.mitre.org/cgi-bin/cvename.cgi?name=2022-44142[CVE-2022-44142] and exposed to network traffic from the internet. As a best practice, upgrade to the latest Samba vfs_fruit module remote code execution version and limit exposure to the internet.  

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2021-44142')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

|===

[#policy-updates]
=== Policy Updates

See xref:../known-issues.adoc[] for a policy status change issue that may affect you.

[cols="50%a,50%a"]
|===
|POLICY UPDATES
|DESCRIPTION


2+|*Policy Updates-RQL*


|*Instance affected by Apache Log4j vulnerability is exposed to network traffic from the internet (CVE-2021-44228)*
//RLP-83964

|*Changes—* The policy RQL has been updated to enhance the scope of network traffic direction.

*Current RQL—*

----
network from vpc.flow_record where bytes > 0 AND source.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2021-44228') ) AND destination.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

*Updated RQL—*

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN (resource where finding.type IN ('Host Vulnerability') AND finding.source IN ('Prisma Cloud') AND finding.name IN ('CVE-2021-44228')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

*Impact—* Low. New alerts will be generated if there any vulnerable resources.

|*Instance affected by OMIGOD vulnerability is exposed to network traffic from the internet*
//RLP-83964

|*Changes—* The policy name and RQL have been updated to enhance the scope of network traffic direction.

*Current Policy Name—* Instance affected by OMIGOD vulnerability is exposed to network traffic from the internet

*Updated Policy Name—* Instance affected by OMIGOD vulnerability is exposed to network traffic from the internet [CVE-2021-38647]

*Current RQL—*

----
network from vpc.flow_record where bytes > 0 AND source.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2021-38647')) AND destination.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

*Updated RQL—*

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN (resource where finding.type IN ('Host Vulnerability') AND finding.source IN ('Prisma Cloud') AND finding.name IN ('CVE-2021-38647')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

*Impact—* Low. New alerts will be generated if there any vulnerable resources.

|*Instance affected by SpringShell vulnerability is exposed to network traffic from the internet*
//RLP-83964

tt:[Requires the Compute subscription to generate alerts on Prisma Cloud.]

|*Changes-* The policy name, description, and RQL are updated to enhance the scope of network traffic direction.

*Current Policy Name—* Instance affected by SpringShell vulnerability is exposed to network traffic from the internet

*Updated Policy Name—* Instance affected by Spring Framework SpringShell vulnerability is exposed to network traffic from the internet [CVE-2022-22965]

*Updated Policy Description—* Identifies Instances installed with the Java Spring Framework version vulnerable to arbitrary code execution https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-22965%5Cn%5CnNOTE:[CVE-2022-22965] and exposed to network traffic from the internet. As a best practice, upgrade the Java Spring Framework version to the latest version and limit exposure to the internet.

*Current RQL—*

----
network from vpc.flow_record where bytes > 0 AND source.resource IN ( resource where finding.type IN ( 'Host Vulnerability' ) AND finding.source IN ( 'Prisma Cloud' ) AND finding.name IN ('CVE-2022-22963', 'CVE-2022-22965')) AND destination.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

*Updated RQL—*

----
network from vpc.flow_record where bytes > 0 AND dest.resource IN (resource where finding.type IN ('Host Vulnerability') AND finding.source IN ('Prisma Cloud') AND finding.name IN ('CVE-2022-22963', 'CVE-2022-22965')) AND source.publicnetwork IN ('Internet IPs', 'Suspicious IPs')
----

*Impact—* Low. New alerts will be generated if there any vulnerable resources.

|*AWS Customer Master Key (CMK) rotation is not enabled*
//RLP-84011

|*Changes—* The policy RQL has been updated to only report custom keys generated by KMS that have the automatic key rotation feature.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name='aws-kms-get-key-rotation-status' AND json.rule = keyMetadata.keyState equals Enabled and keyMetadata.keyManager equals CUSTOMER and (rotation_status.keyRotationEnabled is false or rotation_status.keyRotationEnabled equals "null") and keyMetadata.customerMasterKeySpec equals SYMMETRIC_DEFAULT
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name='aws-kms-get-key-rotation-status' AND json.rule = keyMetadata.keyState equals Enabled and keyMetadata.keyManager equals CUSTOMER and keyMetadata.origin equals AWS_KMS and (rotation_status.keyRotationEnabled is false or rotation_status.keyRotationEnabled equals "null") and keyMetadata.customerMasterKeySpec equals SYMMETRIC_DEFAULT
----

*Impact—* Medium. Existing alerts will be resolved as Policy_Updated for KMS resources configured with asymmetric keys. 

|*Azure App Service Web app doesn't use latest Java version*
//RLP-78796

|*Changes—* The policy RQL has been updated to check the updated Java version supported by the vendor.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'properties.state equals Running and ((config.isJava11VersionLatest exists and config.isJava11VersionLatest equals false) or (config.javaVersion exists and (config.javaVersion does not equal 1.8 and config.javaVersion does not equal 11)) or (config.linuxFxVersion is not empty and config.linuxFxVersion contains JAVA and config.linuxFxVersion contains 8 and config.linuxFxVersion does not contain 8-jre8) or (config.linuxFxVersion is not empty and config.linuxFxVersion contains JBOSSEAP and config.linuxFxVersion does not contain 7-java8) or (config.linuxFxVersion is not empty and config.linuxFxVersion contains TOMCAT and config.linuxFxVersion does not contain -jre8))'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'properties.state equals Running and ((config.javaVersion exists and config.javaVersion does not equal 1.8 and config.javaVersion does not equal 11 and config.javaVersion does not equal 17) or (config.linuxFxVersion is not empty and config.linuxFxVersion contains JAVA and (config.linuxFxVersion contains 8 or config.linuxFxVersion contains 11 or config.linuxFxVersion contains 17) and config.linuxFxVersion does not contain 8-jre8 and config.linuxFxVersion does not contain 11-java11 and config.linuxFxVersion does not contain 17-java17) or (config.linuxFxVersion is not empty and config.linuxFxVersion contains JBOSSEAP and config.linuxFxVersion does not contain 7-java8 and config.linuxFxVersion does not contain 7-java11 and config.linuxFxVersion does not contain 7-java17) or (config.linuxFxVersion contains TOMCAT and config.linuxFxVersion does not end with 10.0-jre8 and config.linuxFxVersion does not end with 9.0-jre8 and config.linuxFxVersion does not end with 8.5-jre8 and config.linuxFxVersion does not end with 10.0-java11 and config.linuxFxVersion does not end with 9.0-java11 and config.linuxFxVersion does not end with 8.5-java11 and config.linuxFxVersion does not end with 10.0-java17 and config.linuxFxVersion does not end with 9.0-java17 and config.linuxFxVersion does not end with 8.5-java17))'
----

*Impact—* Low. Alerts generated for Java version 17 will be resolved as Policy_Updated. 


2+|*Policy Updates—Metadata*


|*GCP Log metric filter and alert does not exist for VPC network changes*
//RLP-83281

|*Changes—* The policy recommendation steps have been updated to reflect the CSP changes.

*Impact—* No impact on alerts.

|*GCP Log metric filter and alert does not exist for IAM custom role changes* 
//RLP-83282

|*Changes—* The policy recommendation steps have been updated to reflect the CSP changes.

*Impact—* No impact on alerts.

|*GCP Log metric filter and alert does not exist for VPC network route changes*
//RLP-83283

|*Changes—* The policy recommendation steps have been updated to reflect the CSP changes.

*Impact—* No impact on alerts.

|*GCP Log metric filter and alert does not exist for Cloud Storage IAM permission changes*
//RLP-83284

|*Changes—* The policy recommendation steps have been updated to reflect the CSP changes.

*Impact—* No impact on alerts.

|*GCP Log metric filter and alert does not exist for Audit Configuration changes*
//RLP-83287

|*Changes—* The policy recommendation steps have been updated to reflect the CSP changes.

*Impact—* No impact on alerts.

|*GCP Log metric filter and alert does not exist for SQL instance configuration changes*
//RLP-83289

|*Changes—* The policy recommendation steps have been updated to reflect the CSP changes.

*Impact—* No impact on alerts.

|*GCP Log metric filter and alert does not exist for VPC Network Firewall rule changes*
//RLP-83290

|*Changes—* The policy recommendation steps have been updated to reflect the CSP changes.

*Impact—* No impact on alerts.

|===


[#changes-in-existing-behavior]
=== Changes in Existing Behavior

[cols="50%a,50%a"]
|===
|FEATURE
|DESCRIPTION

+++<draft-comment>RLP-75166</draft-comment>+++
|*Global Region Support for Google Compute Engine*

|Prisma Cloud now provides global region support for screen:[gcloud-compute-instance-template] API. Due to this, all the resources will be deleted once, and then regenerated on the management console.
Existing alerts corresponding to these resources are resolved as Resource_Updated, and new alerts will be generated against the policy
violations.

*Impact—* You may notice a reduced count for the number of alerts. However, the alert count will return to the original numbers once the resources for screen:[gcloud-compute-instance-template] start ingesting data again.

+++<draft-comment>RLP-74909</draft-comment>+++
|*Region Support for Google Cloud Load Balancing APIs*

|Prisma Cloud can now store regional resources as well as global resources for screen:[gcloud-compute-target-http-proxies] and screen:[gcloud-compute-target-https-proxies] APIs. Due to this, new alerts will be generated against policy violations.

*Impact*—You may notice an increased count in the number of alerts for screen:[gcloud-compute-target-http-proxies and gcloud-compute-target-https-proxies] APIs.

+++<draft-comment>RLP-80585</draft-comment>+++
|*Alerts for Audit Events*


|To make your experience with audit event alerts consistent with configuration alerts for custom policies, the policy evaluation for audit events is updated to use the alert rule configuration. The targets for the cloud accounts and cloud regions for which you want to trigger alerts are now only inherited from the alert rule.

Earlier, when you run an audit event query on the *Investigate* page, and save the query as a saved search and then use this saved search query as match criteria in a policy, the matched issues that trigger alerts used inputs from both the alert rule configuration and saved search.

As an example, if you had created a saved search that includes the RQL for cloud.account, cloud.accountgroup, or cloud.region, such as userinput:[event from cloud.audit_logs where cloud.account = 'Developer Sandbox' AND cloud.region = 'AWS Canada' AND operation IN ('DeleteAccessKey')] the cloud.account, and cloud.region attributes will now be ignored for custom and existing policies and their associated alerts.

Only, the target cloud accounts and cloud regions that you specify in the alert rule configuration will be used to scope when alerts are generated for the custom Audit Event policy.

*Impact—* The change in how the targets for generating alerts scoped may result in a larger number of alerts than before. This change will be rolled out gradually over multiple phases.


|===

[#new-compliance-benchmarks-and-updates]
=== New Compliance Benchmarks and Updates

[cols="50%a,50%a"]
|===
|COMPLIANCE BENCHMARK
|DESCRIPTION


|*Multi-Level Protection Scheme 2.0 (Level 2)*

//RLP-84998
|Prisma Cloud now supports the Multi-Level Protection Scheme 2.0 (Level 2) compliance standard.
This level of information security is based on the compliance standard that nearly all domestic and foreign companies operating in China must follow.

With this support, you can now view this built-in standard and the related policies On Prisma Cloud's "Compliance > Standard" page. Additionally, you can generate reports for immediate viewing or download, or you can schedule recurring reports to keep track of this compliance over time.

|*Secure Controls Framework (SCF)*

//RLP-84997
|Prisma Cloud now supports the Secure Controls Framework (SCF) - 2022.2.1 standards.
The Secure Controls Framework (SCF) is a meta-framework that corresponds to more than 100 industry frameworks and laws related to cybersecurity and privacy.

The SCF is concerned with internal controls. These are the cybersecurity and privacy policies, standards, procedures, and other processes designed to provide reasonable assurance that business objectives will be met and unwanted events will be prevented, detected, and corrected.

With this support, you can now view this built-in standard and the related policies On Prisma Cloud's "Compliance > Standard" page. Additionally, you can generate reports for immediate viewing or download, or you can schedule recurring reports to keep track of this compliance over time.

|===

[#rest-api-updates]
=== REST API Updates

[cols="37%a,63%a"]
|===
|CHANGE
|DESCRIPTION


|*Alert Response Count Updates*

+++<draft-comment>RLP-81552</draft-comment>+++
|If no *limit* parameter is specified in the request, the maximum number of alerts returned in a single response is 10,000 for the following Alerts APIs:

* https://prisma.pan.dev/api/cloud/cspm/alerts#operation/post-alerts-v2[POST - /v2/alert]
* https://prisma.pan.dev/api/cloud/cspm/alerts#operation/get-alerts-v2[GET - /v2/alert]
* https://prisma.pan.dev/api/cloud/cspm/alerts#operation/post-alerts[POST - /alert]
* https://prisma.pan.dev/api/cloud/cspm/alerts#operation/get-alerts[GET - /alert]

[NOTE]
====
To retrieve more than 10000 alerts, use a v2 method of this API with the *pageToken* parameter for pagination.
====


|*Asset Explorer API*

+++<draft-comment>RLP-80019</draft-comment>+++
|The following new endpoint returns detailed information for the asset with the given id:

* https://prisma.pan.dev/api/cloud/cspm/asset-explorer/#operation/asset_2[POST /uai/v1/asset]




|===
