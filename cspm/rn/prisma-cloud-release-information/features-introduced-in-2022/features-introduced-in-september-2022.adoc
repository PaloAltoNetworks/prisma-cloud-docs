[#id2cf92070-b28d-457c-a42b-8867139c4c41]
== Features Introduced in September 2022

Learn what's new on Prisma™ Cloud in September 2022.

* xref:#idea4f8f81-cdb1-4138-9479-44f9d9f353ab[New Features Introduced in 22.9.2]
* xref:#id62d9158d-d217-4bf8-8677-5e543030d9eb[New Features Introduced in 22.9.1]


[#idea4f8f81-cdb1-4138-9479-44f9d9f353ab]
=== New Features Introduced in 22.9.2

* xref:#ida5bf6849-7ac3-47aa-a0b2-ba39f69eadca[New Features]
* xref:#id80c198b3-a443-496b-92d5-b99002c2877b[API Ingestions]
* xref:#id8d5d45ec-5caa-4b1e-bc65-cde48efd514b[New Policies]
* xref:#id8a65cb3f-b405-4dc4-a1a2-7fe21728aa33[Policy Updates]
* xref:#ida31148c4-d4b8-4ca3-ada8-e5a3ff77c458[New Compliance Benchmarks and Updates]
* xref:#id7011a330-69c1-4ca8-8710-c3a1ef21b847[Change in Existing Behavior]
* xref:#id44e2bf78-bc94-4faf-9fa1-348582eb952c[REST API Updates]


[#ida5bf6849-7ac3-47aa-a0b2-ba39f69eadca]
=== New Features

[cols="50%a,50%a"]
|===
|FEATURE
|DESCRIPTION


|tt:[GA] *Prisma Cloud Data Security—Support for Azure Subscription*

+++<draft-comment>RLP-75673</draft-comment>+++

|Prisma Cloud now supports data security for your Azure Subscription accounts. After https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/prisma-cloud-data-security/enable-data-security-module/add-a-new-azure-account-pcds[configuring] Prisma Cloud Data Security for Azure, you can discover and classify data stored in Azure Blob Storage and protect accidental exposure, misuse, or sharing of sensitive data.

You can set up Forward and Backward scan to scan your Azure resources for data security issues. You can also set up a custom scan or choose to scan all objects.

Prisma Cloud supports the following file types and size for Azure:

* For data classification scanning the file size must be less than 20MB
* For malware scanning the file size must be less than 20MB
* Exposure evaluation for all file types.

Prisma Cloud provides out-of-the-box policies to detect sensitive blobs exposed in public storage accounts and malware blobs in Azure Blob storage accounts.

image::pcds-data-policies.png[scale=30]

You can also create your own customized https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/prisma-cloud-data-security/monitor-data-security-scan-prisma-cloud/data-policies[data security policy].

[NOTE]
====
API support is not currently provided for Prisma Cloud Data Security for Azure.
====


|tt:[Update] *Prisma Cloud Data Security for AWS—New File Extension Supported for Data Classification Scanning*


+++<draft-comment>RLP-75775</draft-comment>+++
|Prisma Cloud can now scan .tsv types of file extensions on your storage buckets for data classification.


|tt:[Update] *Prisma Cloud Data Security for AWS—New Missing Permission*


+++<draft-comment>RLP-68621</draft-comment>+++
|Prisma Cloud displays s3:GetObject missing permission on the *Data Security Settings* page when your AWS bucket has KMS encryption enabled and Prisma Cloud does not have access to the bucket. You can https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/prisma-cloud-data-security/troubleshoot-data-security-errors#troubleshoot-data-security-errors[resolve] the issue and then configure data security for that bucket.

image::pcds-missing-perms-2.png[scale=40]

|===



[#id80c198b3-a443-496b-92d5-b99002c2877b]
=== API Ingestions

[cols="50%a,50%a"]
|===
|SERVICE
|API DETAILS


|*AWS DataSync*


+++<draft-comment>RLP-76367</draft-comment>+++
|*aws-datasync-location*

Additional permissions required:

* screen:[datasync:DescribeLocationEfs]
* screen:[datasync:ListLocations]
* screen:[datasync:DescribeLocationSmb]
* screen:[datasync:DescribeLocationSmb]
* screen:[datasync:DescribeLocationFsxOpenZfs]
* screen:[datasync:DescribeLocationFsxWindows]
* screen:[datasync:DescribeLocationS3]
* screen:[datasync:DescribeLocationObjectStorage]
* screen:[datasync:DescribeLocationFsxOntap]
* screen:[datasync:ListTagsForResource]
* screen:[datasync:ListTasks]
* screen:[datasync:DescribeLocationHdfs]
* screen:[datasync:DescribeLocationFsxLustre]
* screen:[datasync:DescribeLocationNfs]


[NOTE]
====
This API will only ingest locations that the Datasync Task uses.
====

The Security Audit role includes this permission.


|*Amazon QLDB*


+++<draft-comment>RLP-76378</draft-comment>+++
|*aws-qldb-ledger*

Additional permissions required:

* screen:[qldb:ListLedgers]
* screen:[qldb:DescribeLedger]
* screen:[qldb:ListTagsForResource]


|*Amazon Translate*


+++<draft-comment>RLP-76372</draft-comment>+++
|*aws-translate-terminology*

Additional permissions required:

* screen:[translate:ListTerminologies]
* screen:[translate:GetTerminology]

The Security Audit role includes the permission:screen:[translate:ListTerminologies].


|*Azure Advisor*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-advisor-configurations*

Additional permission required:screen:[Microsoft.Advisor/configurations/read]

The Reader role includes the permission.


|*Azure Analysis Services*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-analysisservices-servers*

Additional permission required:screen:[Microsoft.AnalysisServices/servers/read]

The Reader role includes the permission.


|*Azure App Configuration*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-appconfiguration-configuration-stores*

Additional permission required:screen:[Microsoft.AppConfiguration/configurationStores/read]

The Reader role includes the permission.


|*Azure Automanage*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-automanage-configuration-profiles*

Additional permission required:screen:[Microsoft.Automanage/configurationProfiles/Read]

The Reader role includes the permission.


|*Azure Container Apps*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-app-container-apps*

Additional permission required:screen:[microsoft.app/containerapps/read]

The Reader role includes the permission.


|*Azure Communication*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-communication-services*

Additional permission required:screen:[Microsoft.Communication/CommunicationServices/Read]

The Reader role includes the permission.


|*Azure Compute*

+++<draft-comment>RLP-76194</draft-comment>+++
|*azure-cloudservices-list*

Additional permission required:screen:[Microsoft.Compute/cloudServices/read]

The Reader role includes the permission.


|*Azure Compute*

+++<draft-comment>RLP-76197</draft-comment>+++
|*azure-cloudservices-roleinstance-publicip*

Additional permissions required:

* screen:[Microsoft.Compute/cloudServices/read]
* screen:[Microsoft.Compute/cloudServices/roleInstances/read]
* screen:[Microsoft.Compute/virtualMachineScaleSets/virtualMachines/networkInterfaces/ipConfigurations/publicIPAddresses/read]

The Reader role includes the permissions.


|*Azure Compute*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-compute-dedicated-host-groups*

Additional permission required:screen:[Microsoft.Compute/hostGroups/read]

The Reader role includes the permission.


|*Azure Hybrid Compute*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-hybridcompute-machines*

Additional permission required:screen:[Microsoft.HybridCompute/machines/read]

The Reader role includes the permission.


|*Azure Managed Grafana*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-dashboard-grafana*

Additional permission required:screen:[Microsoft.Dashboard/grafana/read]

The Reader role includes the permission.


|*Azure Stack HCI*

+++<draft-comment>RLP-78142</draft-comment>+++
|*azure-azurestackhci-clusters*

Additional permission required:screen:[Microsoft.AzureStackHCI/Clusters/Read]

The Reader role includes the permission.


|*Azure Virtual Network*

+++<draft-comment>RLP-76192</draft-comment>+++
|*azure-network-public-ip-prefixes*

Additional permission required:screen:[Microsoft.Network/publicIPPrefixes/read]

The Reader role includes the permission.


|*Google Dataproc Clusters*

+++<draft-comment>RLP-76206</draft-comment>+++
|*gcloud-dataproc-autoscaling-policy*

Additional permissions required:

* screen:[dataproc.autoscalingPolicies.list]
* screen:[dataproc.autoscalingPolicies.getIamPolicy]

The Viewer role includes these permissions.


|*Google Dataplex*

+++<draft-comment>RLP-76231</draft-comment>+++
|*gcloud-dataplex-lake*

Additional permissions required:

* screen:[dataplex.locations.list]
* screen:[dataplex.lakes.list]
* screen:[dataplex.lakes.getIamPolicy]

The Viewer role includes these permissions.


|*Google Recommendation*

+++<draft-comment>RLP-76224</draft-comment>+++
|*gcloud-recommender-organization-iam-policy-lateral-movement-insight*

Additional permission required:screen:[recommender.iamPolicyLateralMovementInsights.list]

The Viewer role includes this permission.

|===



[#id8d5d45ec-5caa-4b1e-bc65-cde48efd514b]
=== New Policies

See the xref:../look-ahead-planned-updates-prisma-cloud.adoc#ida01a4ab4-6a2c-429d-95be-86d8ac88a7b4[look ahead updates] for planned features and policy updates for 22.10.1

[cols="50%a,50%a"]
|===
|POLICY NAME
|DESCRIPTION


|*AWS ElastiCache Memcached cluster with in-transit encryption disabled*

+++<draft-comment>RLP-75380</draft-comment>+++
|Identifies AWS ElastiCache Memcached clusters that have in-transit encryption disabled. It is highly recommended to implement in-transit encryption in order to protect data from unauthorized access as it travels through the network, between clients and cache servers. Enabling data encryption in-transit helps to prevent unauthorized users from reading sensitive data between your Memcached and their associated cache storage systems.

screen:[config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-elasticache-cache-clusters' AND json.rule = engine equals memcached and transitEncryptionEnabled is false]


|*Azure SQL server Transparent Data Encryption (TDE) encryption disabled*

+++<draft-comment>RLP-76786</draft-comment>+++
|Identifies SQL servers in which Transparent Data Encryption (TDE) is disabled. TDE encryption performs real-time encryption and decryption of the server, related reinforcements, and exchange log records without requiring any changes to the application. It is recommended to have TDE encryption on your SQL servers to protect the server from malicious activity.

----
config from cloud.resource where cloud.type = 'azure' and api.name = 'azure-sql-server-list' AND json.rule = ['sqlServer'].['properties.state'] equal ignore case Ready and sqlEncryptionProtectors[*].kind does not exist
----


|*Azure VM OS disk is not configured with any encryption*

+++<draft-comment>RLP-76788</draft-comment>+++
|Identifies VM OS disks that are not configured with any encryption. Azure offers Server-Side Encryption (SSE) with platform-managed keys [SSE with PMK] by default for managed disks. It is recommended to enable default encryption or you may optionally choose to use a customer-managed key to protect from malicious activity.

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-disk-list' and json.rule = osType exists and managedBy exists and (encryptionSettings does not exist or encryptionSettings.enabled is false) and encryption.type is not member of ("EncryptionAtRestWithCustomerKey","EncryptionAtRestWithPlatformAndCustomerKeys","EncryptionAtRestWithPlatformKey")
----


|*Azure data disk is not configured with any encryption*

+++<draft-comment>RLP-76789</draft-comment>+++
|Identifies VM data disks that are not configured with any encryption. Azure offers Server-Side Encryption (SSE) with platform-managed keys [SSE with PMK] by default for managed disks. It is recommended to enable default encryption or you may optionally choose to use a customer-managed key to protect from malicious activity.

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-disk-list' AND json.rule = osType does not exist and managedBy exists and (encryptionSettings does not exist or encryptionSettings.enabled is false) and encryption.type is not member of ("EncryptionAtRestWithCustomerKey", "EncryptionAtRestWithPlatformAndCustomerKeys","EncryptionAtRestWithPlatformKey")
----


|*GCP KMS crypto key is anonymously accessible*

+++<draft-comment>RLP-58537</draft-comment>+++
|Identifies GCP KMS crypto keys that are anonymously accessible. Granting permissions to 'allUsers' or 'allAuthenticatedUsers' allows anyone to access the KMS key. As a security best practice, it is recommended not to bind such members to KMS IAM policy.

----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-kms-crypto-keys-list' AND json.rule = ((purpose does not equal ENCRYPT_DECRYPT) or (purpose equals ENCRYPT_DECRYPT and primary.state equals ENABLED)) and iamPolicy.bindings[*].members contains allUsers or iamPolicy.bindings[*].members contains allAuthenticatedUsers
----


|*GCP Cloud Run service is publicly accessible*

+++<draft-comment>RLP-43095</draft-comment>+++
|Identifies GCP Cloud Run services that are publicly accessible. Granting Cloud Run Invoker permission to 'allUsers' or 'allAuthenticatedUsers' allows anyone to access the Cloud Run service over internet. Such access might not be desirable if sensitive data is stored at the location. As security best practice it is recommended to remove public access and assign the least privileges to the GCP Cloud Run service according to requirements.

----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-cloud-run-services-list' AND json.rule = status.conditions[?any(type equals Ready and status equals True)] exists and status.conditions[?any(type equals RoutesReady and status equals True)] exists and iamPolicy.bindings[?any(role equals roles/run.invoker and members is member of (allUsers, allAuthenticatedUsers))] exists
----


|*GCP Log metric filter and alert does not exist for VPC network route patch and insert*

+++<draft-comment>RLP-75908</draft-comment>+++
|Identifies GCP accounts which do not have a log metric filter and alert for VPC network route patch and insert events. Monitoring network routes patching and insertion activities will help in identifying VPC traffic flows through an expected path. It is recommended to create a metric filter and alarm to detect activities related to the patch and insertion of VPC network routes.

----
config from cloud.resource where api.name = 'gcloud-logging-metric' as X; config from cloud.resource where api.name = 'gcloud-monitoring-policies-list' as Y; filter '$.Y.conditions[*].metricThresholdFilter contains $.X.name  and ( $.X.filter does not contain "resource.type =" or $.X.filter does not contain "resource.type=" ) and ( $.X.filter does not contain "resource.type !=" and $.X.filter does not contain "resource.type!=" ) and $.X.filter contains "gce_route" and ( $.X.filter contains "protoPayload.methodName="  or $.X.filter contains "protoPayload.methodName =" ) and ( $.X.filter does not contain "protoPayload.methodName!=" and $.X.filter does not contain "protoPayload.methodName !=" ) and $.X.filter contains "beta.compute.routes.patch" and $.X.filter contains "beta.compute.routes.insert"'; show X; count(X) less than 1
----


|*GCP Log metric filter and alert does not exist for VPC network route delete and insert*

+++<draft-comment>RLP-75909</draft-comment>+++
|Identifies GCP accounts which do not have a log metric filter and alert for VPC network route delete and insert events. Monitoring network routes deletion and insertion activities will help in identifying VPC traffic flows through an expected path. It is recommended to create a metric filter and alarm to detect activities related to the deletion and insertion of VPC network routes.

----
config from cloud.resource where api.name = 'gcloud-logging-metric' as X; config from cloud.resource where api.name = 'gcloud-monitoring-policies-list' as Y; filter '$.Y.conditions[*].metricThresholdFilter contains $.X.name and ( $.X.filter does not contain "resource.type =" or $.X.filter does not contain "resource.type=" ) and ( $.X.filter does not contain "resource.type !=" and $.X.filter does not contain "resource.type!=" ) and $.X.filter contains "gce_route" and ( $.X.filter contains "protoPayload.methodName:" or $.X.filter contains "protoPayload.methodName :" ) and ( $.X.filter does not contain "protoPayload.methodName!:" and $.X.filter does not contain "protoPayload.methodName !:" ) and $.X.filter contains "compute.routes.delete" and $.X.filter contains "compute.routes.insert"'; show X; count(X) less than 1
----

|===



[#id8a65cb3f-b405-4dc4-a1a2-7fe21728aa33]
=== Policy Updates

[cols="50%a,50%a"]
|===
|POLICY NAME
|DESCRIPTION


2+|*Policy Updates—RQL*


|*Azure Function App doesn't redirect HTTP to HTTPS*

+++<draft-comment>RLP-74419</draft-comment>+++
|*Changes—* The policy RQL is enhanced to check for apps that are in the Running state and to increase accuracy of alerts.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'kind contains functionapp and properties.httpsOnly equals false'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case Running and kind contains functionapp and properties.httpsOnly is false
----

*Impact—* Low. Previously generated alerts for apps in the Stopped state will be resolved as Policy_Updated.


|*Azure Function App doesn't use HTTP 2.0*

+++<draft-comment>RLP-74419</draft-comment>+++
|*Changes—* The policy RQL is enhanced to check for apps that are in the Running state and to increase accuracy of alerts.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'kind contains functionapp and config.http20Enabled equals false'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case Running and kind contains functionapp and config.http20Enabled is false
----

*Impact—* Low. Previously generated alerts for apps in the Stopped state will be resolved as Policy_Updated.


|*Azure Function App authentication is off*

+++<draft-comment>RLP-74419</draft-comment>+++
|*Changes—* The RQL has been updated to check apps with status 'RUNNING'. The recommendation steps have also been updated to match the latest UI changes.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'kind contains functionapp and config.siteAuthEnabled equals false'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case Running and kind contains functionapp and config.siteAuthEnabled is false
----

*Impact—* Low. Previously generated alerts for apps in the Stopped state will be resolved as Policy_Updated.


|*Azure Function App client certificate is disabled*

+++<draft-comment>RLP-74419</draft-comment>+++
|*Changes—* The RQL has been updated to check apps with status 'RUNNING'.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'kind contains functionapp and properties.clientCertEnabled equals false'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case Running and kind contains functionapp and properties.clientCertEnabled is false
----

*Impact—* Low. Previously generated alerts for apps in the Stopped state will be resolved as Policy_Updated.


|*Azure Function App doesn't use latest TLS version*

+++<draft-comment>RLP-74419</draft-comment>+++
|*Changes—* The RQL has been updated to check apps with status 'RUNNING'.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'kind contains functionapp and config.minTlsVersion does not equal 1.2'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case Running and kind contains functionapp and config.minTlsVersion does not equal "1.2"
----

*Impact—* Low. Previously generated alerts for apps in the Stopped state will be resolved as Policy_Updated.


|*Azure Function App doesn't have a Managed Service Identity*

+++<draft-comment>RLP-74419</draft-comment>+++
|*Changes—* The RQL has been updated to check apps with status 'RUNNING'. The recommendation steps have also been updated to match the latest UI changes.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'kind contains functionapp and (identity.type does not exist or identity.type does not equal SystemAssigned or identity.principalId is empty)'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = properties.state equal ignore case Running and kind contains functionapp and (identity.type does not exist or identity.principalId is empty)
----

*Impact—* Low. Previously generated alerts for apps in the Stopped state will be resolved as Policy_Updated.


|*Azure SQL Server audit log retention is less than 91 days*

+++<draft-comment>RLP-76030</draft-comment>+++
|*Changes—* The policy RQL and recommendation steps have been updated to check for only storage account log retention because log retention cannot be set for other log destinations.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-sql-server-list' AND json.rule =  "$.serverBlobAuditingPolicy.properties.state == Enabled and ($.serverBlobAuditingPolicy.properties.retentionDays != 0 and $.serverBlobAuditingPolicy.properties.retentionDays < 91)"
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-sql-server-list' AND json.rule = serverBlobAuditingPolicy.properties.state equal ignore case Enabled and serverBlobAuditingPolicy.properties.storageEndpoint is not empty and (serverBlobAuditingPolicy.properties.retentionDays does not equal 0 and serverBlobAuditingPolicy.properties.retentionDays < 91)
----

*Impact—* The alerts generated for log destinations other than storage account log destinations are resolved as Policy_Updated.


2+|*Policy Updates—Metadata*


|*Azure App Service Web app client certificate is disable*

+++<draft-comment>RLP-78253</draft-comment>+++
|*Changes—* The policy recommendation steps have been updated to include precise steps.

*Impact—* No impact on alerts.


|*Azure SQL server TDE protector is not encrypted with BYOK (Use your own key)*

+++<draft-comment>RLP-77201</draft-comment>+++
|*Changes—* The policy recommendation steps have been updated.

*Impact—* No impact on alerts.


|*Azure App Service Web app doesn't use latest Python version*

+++<draft-comment>RLP-77039</draft-comment>+++
|*Changes—* The policy description and recommendation steps have been updated to reflect the CSP UI changes.

*Updated Description—* Identifies App Service Web apps that are not configured with latest Python version. Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. It is recommended to use the latest Python version for web apps in order to take advantage of security fixes, if any.

*Impact—* No impact on alerts.


|*Azure App Service Web app doesn't use latest PHP version*

+++<draft-comment>RLP-77039</draft-comment>+++
|*Changes—* The policy description and recommendation steps have been updated to reflect the CSP UI changes.

*Updated Description—* Identifies App Service Web apps that are not configured with latest PHP version. Periodically, newer versions are released for PHP software either due to security flaws or to include additional functionality. It is recommended to use the latest PHP version for web apps in order to take advantage of security fixes, if any.

*Impact—* No impact on alerts.


|*Azure App Service Web app doesn't use latest .Net Core version*

+++<draft-comment>RLP-77039</draft-comment>+++
|*Changes—* The policy description and recommendation steps have been updated to reflect the CSP UI changes.

*Updated Description—* Identifies App Service Web apps that are not configured with latest .Net Core version. Periodically, newer versions are released for .Net Core software either due to security flaws or to include additional functionality. It is recommended to use the latest .Net version for web apps in order to take advantage of security fixes, if any.

*Impact—* No impact on alerts.


|*Azure Resource Group does not have a resource lock*

+++<draft-comment>RLP-76217</draft-comment>+++
|*Changes—* The policy recommendation steps have been updated.

*Impact—* No impact on alerts.


2+|If you have enabled the Code Security subscription on Prisma Cloud, see xref:../../prisma-cloud-code-security-release-information/features-introduced-in-code-security-2022/features-introduced-in-code-security-september-2022.adoc#id0c994ba4-e03a-42bf-8b07-72cc0f08db25[Code Security - Features Introduced in September 2022] for details on new Configuration Build policies and updates to add build rules for existing Configuration Run policies.

+++<draft-comment>RLP-76633</draft-comment>+++

|===


[#ida31148c4-d4b8-4ca3-ada8-e5a3ff77c458]
=== New Compliance Benchmarks and Updates

[cols="50%a,50%a"]
|===
|COMPLIANCE BENCHMARK
|DESCRIPTION


|*Support for Korea-Information Security Management System (K-ISMS)*

+++<draft-comment>RLP-78048</draft-comment>+++
|Support is now available for Korea Information Security Management System (K-ISMS). This benchmark is a certification system to assess if an enterprise's or organization's information security management system is properly established, managed, and operated.

|===


[#id7011a330-69c1-4ca8-8710-c3a1ef21b847]
=== Change in Existing Behavior

[cols="50%a,50%a"]
|===
|FEATURE
|DESCRIPTION


|*Access to Data for Deleted Assets*

tt:[First announced in 22.4.1 and updated in 22.8.1 to list the new API.]
|The ability to view and investigate data for assets that have been deleted in cloud accounts which are onboarded to Prisma Cloud will be available for up to *90 days* after asset deletion. This is a change from the current behavior where you had access to the historical data for deleted assets, starting from the time you onboarded the account on Prisma Cloud.

To align with this change, Prisma Cloud will limit the time range filters to 90 days of history. To support use cases where further retention is required, a new API end point is available to Prisma Cloud users with the System Admin role to retrieve deleted asset records. For API details, see https://prisma.pan.dev/api/cloud/cspm/archived-assets[GET/config/api/v1/tenant/{prisma_id}/archiveList].

+++<draft-comment>feature blurb that Matangi wrote: RLP-46456; was updated with 22.7.1 to say Sept instead of July, and in 22.8.1 to add the new API.</draft-comment>+++

+++<draft-comment>Rolled back the change based on comments received in RLP-75018. Need to move this blurb in 22.9.2.</draft-comment>+++

|===


[#id44e2bf78-bc94-4faf-9fa1-348582eb952c]
=== REST API Updates

No REST API updates for 22.9.2.


[#id62d9158d-d217-4bf8-8677-5e543030d9eb]
=== New Features Introduced in 22.9.1

* xref:#id768c6dcd-424d-483a-b3f7-23de5b690b3c[New Features]
* xref:#id0cae8247-b0c6-448d-8f9f-83f1684fc935[API Ingestions]
* xref:#id4d13f770-4a53-4474-acbd-caae4039401c[New Policies]
* xref:#id7575e4fc-c858-46b8-a0a4-52238a2a38d2[Policy Updates]
* xref:#idbb5b744d-bff5-451f-8fe8-5049d9adac8c[Change in Existing Behavior]
* xref:#idd803cff2-3dfe-4505-be04-06933eae8093[REST API Updates]


[#id768c6dcd-424d-483a-b3f7-23de5b690b3c]
=== New Features

[cols="50%a,50%a"]
|===
|FEATURE
|DESCRIPTION

|*Top Priority Security Risks View with Command Center*

+++<draft-comment>RLP-74327</draft-comment>+++
|The https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/prisma-cloud-dashboards/command-center-dashboard[Command Center Dashboard] provides you with a unified view of the top cloud security incidents and risks discovered across all the assets monitored by Prisma Cloud, grouped by the following threat vectors:

* Incidents
* Misconfigurations
* Exposures
* Identity Risks
* Data Risks

Customizable filters allow you to isolate threat activity by time range, asset and account groups for further investigation. Now your security team has the actionable insight you need to resolve the highest priority incidents, and risks across all your cloud resources.

image::command-center-dashboard.gif[scale=25]


|*IAM Security Supports AWS Permission Boundaries*

+++<draft-comment>RLP-75691</draft-comment>+++
|Prisma Cloud’s IAM security module algorithm now supports AWS Permission Boundaries in the Net Effective Permissions calculations, to help you better identify when a permission was last used.


|*Cloud Network Analyzer Support for Azure*

+++<draft-comment>RLP-77912</draft-comment>+++
|Prisma Cloud now supports https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/prisma-cloud-network-security[network] exposure queries on Azure cloud environments. You can now calculate the net effective reachability for virtual machines or PaaS service in Azure.

image::cna-azure-1.png[scale=30]


|tt:[Update] *Azure Onboarding Permission*

+++<draft-comment>RLP-76895</draft-comment>+++
|If you are using Custom role while https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin/connect-your-cloud-platform-to-prisma-cloud/onboard-your-azure-account/azure-onboarding-checklist[onboarding] your Azure account, as per Microsoft’s recommendation, you need to add *Microsoft.Network/networkWatchers/queryFlowLogStatus/** in order to provide read-only permission to query flow log status in Network Watcher.

|===


[#id0cae8247-b0c6-448d-8f9f-83f1684fc935]
=== API Ingestions

[cols="50%a,50%a"]
|===
|SERVICE
|API DETAILS


|*AWS Amplify*

+++<draft-comment>RLP-75301</draft-comment>+++
|*aws-amplify-app*

Additional permission required: screen:[amplify:ListApps]


|*AWS Global Accelerator*

+++<draft-comment>RLP-75296</draft-comment>+++
|*aws-global-accelerator-accelerator*

Additional permissions required:

* screen:[globalaccelerator:ListTagsForResource]
* screen:[globalaccelerator:ListAccelerators]
* screen:[globalaccelerator:DescribeAcceleratorAttributes]

The Security Audit role includes this permission.


|*Amazon Route53*

+++<draft-comment>RLP-75307</draft-comment>+++
|*aws-route53-query-logging-config*

Additional permission required: screen:[route53:ListQueryLoggingConfigs]

The Security Audit role includes this permission.


|*Azure HDInsight*

+++<draft-comment>RLP-75468</draft-comment>+++
|*azure-hdinsight-applications*

Additional permissions required:

* screen:[Microsoft.HDInsight/clusters/read]
* screen:[Microsoft.HDInsight/clusters/applications/read]

The Reader role includes the permissions.


|*Azure Subscriptions*

+++<draft-comment>RLP-75471</draft-comment>+++
|*azure-subscription-tenantpolicy*

Additional permission required:screen:[Microsoft.Subscription/Policies/default/read]

The Reader role includes the permission.


|*Google Cloud Data Loss Prevention*

+++<draft-comment>RLP-75288</draft-comment>+++
|*gcloud-dlp-project-stored-infotype*

Additional permission required:

screen:[dlp.storedInfoTypes.list]

The Viewer role includes this permission.


|*Google Recommendation*

+++<draft-comment>RLP-75287</draft-comment>+++
|*gcloud-recommender-project-iam-policy-lateral-movement-insight*

Additional permission required:

screen:[recommender.iamPolicyLateralMovementInsights.list]

The Viewer role includes this permission.


|*Google Dataproc Clusters*

+++<draft-comment>RLP-75284</draft-comment>+++
|*gcloud-dataproc-workflow-template*

Additional permission required:

* screen:[dataproc.workflowTemplates.list]
* screen:[dataproc.workflowTemplates.getIamPolicy]

The Viewer role includes this permission.


|*OCI MySQL*

+++<draft-comment>RLP-74439</draft-comment>+++
|*oci-mysql-dbsystems*

Additional permissions required:

* screen:[read mysql-insta]
* screen:[inspect mysql-instances]

You must add these permissions manually.

|===


[#id4d13f770-4a53-4474-acbd-caae4039401c]
=== New Policies

See the xref:../look-ahead-planned-updates-prisma-cloud.adoc#ida01a4ab4-6a2c-429d-95be-86d8ac88a7b4[look ahead updates] for planned features and policy updates for 22.9.2.

[cols="50%a,50%a"]
|===
|POLICY NAME
|DESCRIPTION


|*AWS SQS Queue not configured with server side encryption*

+++<draft-comment>RLP-76136</draft-comment>+++
|Identifies AWS SQS queues which are not configured with server side encryption. Enabling server side encryption would encrypt all messages that are sent to the queue and the messages are stored in encrypted form. Amazon SQS decrypts a message only when it is sent to an authorized consumer. It is recommended to enable server side encryption for AWS SQS queues in order to protect sensitive data in the event of a data breach or malicious users gaining access to the data.

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-sqs-get-queue-attributes' AND json.rule = attributes.KmsMasterKeyId does not exist and attributes.SqsManagedSseEnabled is false
----


|*Azure PostgreSQL (PaaS) instance reachable from untrust internet source on TCP port 5432*

+++<draft-comment>RLP-74593</draft-comment>+++
|Identifies Azure PostgreSQL (PaaS) instances that are internet reachable from an untrust internet source on TCP port 5432. PostgreSQL (PaaS) instances with untrusted access to the internet may enable bad actors to use brute force on a system to gain unauthorized access to the entire network. As a best practice, restrict traffic from untrusted IP addresses and limit access to known hosts, services, or specific entities.

----
config from network where source.network = UNTRUST_INTERNET and dest.resource.type = 'PaaS' and dest.cloud.type = 'AZURE' and dest.paas.service.type in ( 'MicrosoftDBforPostgreSQLFlexibleServers', 'MicrosoftDBforPostgreSQLServers' ) and protocol.ports = 'tcp/5432'
----


|*Azure MySQL (PaaS) instance reachable from untrust internet source on TCP port 3306*

+++<draft-comment>RLP-74592</draft-comment>+++
|Identifies Azure MySQL (PaaS) instances that are internet reachable from an untrust internet source on TCP port 3306. MySQL (PaaS) instances with untrusted access to the internet may enable bad actors to use brute force on a system to gain unauthorized access to the entire network. As a best practice, restrict traffic from untrusted IP addresses and limit access to known hosts, services, or specific entities.

----
config from network where source.network = UNTRUST_INTERNET and dest.resource.type = 'PaaS' and dest.cloud.type = 'AZURE' and dest.paas.service.type in ( 'MicrosoftDBforMySQLFlexibleServers', 'MicrosoftDBforMySQLServers' ) and protocol.ports = 'tcp/3306'
----


|*Azure VM instance in running state that is internet reachable with unrestricted access (0.0.0.0/0) other than HTTP/HTTPS port*

+++<draft-comment>RLP-74589</draft-comment>+++
|Identifies Azure VM instances in running state that is internet reachable with unrestricted access (0.0.0.0/0) other than HTTP/HTTPS port. VM instances with unrestricted access to the internet may enable bad actors to use brute force on a system to gain unauthorized access to the entire network. As a best practice, restrict traffic from unknown IP addresses and limit access to known hosts, services, or specific entities.

[NOTE]
====
The HTTP-80 and HTTPs-443 web ports are excluded as these are internet-facing ports with legitimate traffic.
====

----
config from network where source.network = '0.0.0.0/0' and address.match.criteria = 'full_match' and dest.resource.type = 'Instance' and dest.cloud.type = 'AZURE' and protocol.ports in ( 'tcp/0:79', 'tcp/81:442', 'tcp/444:65535' ) and dest.resource.state = 'Active'
----


|*GCP BigQuery Dataset not configured with default CMEK*

+++<draft-comment>RLP-72259</draft-comment>+++
|Identifies BigQuery Datasets that are not configured with default CMEK. Setting a Default Customer-Managed Encryption Key (CMEK) for a data set ensures any tables created in the future will use the specified CMEK if none other is provided. It is recommended to configure all BigQuery Datasets with default CMEK.

----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-bigquery-dataset-list' AND json.rule = defaultEncryptionConfiguration.kmsKeyName does not exist]
----


|*GCP Cloud Function is publicly accessible*

+++<draft-comment>RLP-42431</draft-comment>+++
|Identifies GCP Cloud Functions that are publicly accessible. Allowing 'allusers' / 'allAuthenticatedUsers' to cloud functions can lead to unauthorized invocation of the functions or unwanted access to sensitive information. It is recommended to follow the least privileged access policy and grant access restrictively.

----
config from cloud.resource where cloud.type = 'gcp' AND api.name = 'gcloud-cloud-function' AND json.rule = status equals ACTIVE and iamPolicy.bindings[?any(members[*] is member of ("allAuthenticatedUsers","allUsers"))] exists
----


.11+|tt:[IAM Security]  *New Policies*

+++<draft-comment>IVG-6056</draft-comment>+++
|*Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Owner*

Managed identities provide an automatic way for applications to connect to resources that support Azure Active Directory (Azure AD) authentication. Using the Azure built-in role of Owner with managed identities provides broad permissions sets for a non-human identity that can lead to privilege escalation. A few examples are: virtual machine lateral movement (like running commands on other VMs), storage account access, and configuration access.

----
config from iam where source.cloud.type = 'Azure' AND grantedby.cloud.entity.type IN ( 'System Assigned', 'User Assigned' ) AND grantedby.cloud.policy.type = 'Built-in Role' AND grantedby.cloud.policy.name = 'Owner'
----


|*Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Contributor*

Managed identities provide an automatic way for applications to connect to resources that support Azure Active Directory (Azure AD) authentication. Using the Azure built-in role of Contributor with managed identities provides broad permissions sets for a non-human identity that can lead to privilege escalation. A few examples are, virtual machine lateral movement (like running commands on other VMs), storage account access, and configuration access.

----
config from iam where source.cloud.type = 'Azure' AND grantedby.cloud.entity.type IN ( 'System Assigned', 'User Assigned' ) AND grantedby.cloud.policy.type = 'Built-in Role' AND grantedby.cloud.policy.name = 'Contributor'
----


|*Azure Managed Identity (user assigned or system assigned) with the Azure built-in roles of Reader*

Managed identities provide an automatic way for applications to connect to resources that support Azure Active Directory (Azure AD) authentication. Using the Azure built-in role of Reader with managed identities provides broad permissions sets for a non-human identity that can lead to several scenarios of subscription information enumeration.

----
config from iam where source.cloud.type = 'Azure' AND grantedby.cloud.entity.type IN ( 'System Assigned', 'User Assigned' ) AND grantedby.cloud.policy.type = 'Built-in Role' AND grantedby.cloud.policy.name = 'Reader'
----


|*Azure Managed Identity (user assigned or system assigned) with Key Vault access*

Managed identities provide an automatic way for applications to connect to resources that support Azure Active Directory (Azure AD) authentication. Providing Key Vault access lets non-human identities query key vaults for credential and secret data.

----
config from iam where source.cloud.type = 'Azure' AND grantedby.cloud.entity.type IN ( 'System Assigned', 'User Assigned' ) AND dest.cloud.service.name = 'Microsoft.KeyVault']
----


|*Azure Managed Identity with permissions to manage Azure permissions broadly that was unused in the last 90 days*

Managed identities provide an automatic way for applications to connect to resources that support Azure Active Directory (Azure AD) authentication. Managed identity with the ability to change Azure permissions through role assignments are risky permission that can lead to privilege escalation.

----
config from iam where source.cloud.type = 'Azure' AND grantedby.cloud.entity.type IN ( 'System Assigned', 'User Assigned' ) AND dest.cloud.resource.name = '*' AND action.name STARTS WITH 'Microsoft.Authorization/roleAssignments/' AND action.lastaccess.days > 90
----


|*Azure Managed Identity with permissions to other subscriptions*

Identifies the Azure resources which can be accessed from another subscription (cross-account) through IAM policies.

----
config from iam where source.cloud.type = 'Azure' AND source.cloud.account != dest.cloud.account AND source.cloud.resource.type != 'user'
----


|*Azure AD user with the Azure built-in roles of Owner*

Using the Azure built-in role of Owner with Azure AD users provides broad permissions sets that can lead to privilege escalation. A few examples are virtual machine lateral movement (like running commands on other VMs), storage account access and configuration access.

----
config from iam where source.cloud.type = 'Azure' AND source.cloud.resource.type = 'user' AND grantedby.cloud.policy.type = 'Built-in Role' AND grantedby.cloud.policy.name = 'Owner'
----


|*Azure AD user with the Azure built-in roles of Contributor*

Using the Azure built-in role of Contributor with Azure AD users provides broad permissions sets that can lead to privilege escalation. A few examples are virtual machine lateral movement (like running commands on other VMs), storage account access and configuration access.

----
config from iam where source.cloud.type = 'Azure' AND source.cloud.resource.type = 'user' AND grantedby.cloud.policy.type = 'Built-in Role' AND grantedby.cloud.policy.name = 'Contributor'
----


|*Azure AD user with the Azure built-in roles of Reader*

Using the Azure built-in role of Reader with Azure AD users provides broad permissions sets that can lead to several scenarios of subscription information enumeration.

----
config from iam where source.cloud.type = 'Azure' AND source.cloud.resource.type = 'user' AND grantedby.cloud.policy.type = 'Built-in Role' AND grantedby.cloud.policy.name = 'Reader'
----


|*Azure AD users with Key Vault access*

Providing Key Vault access lets users query key vaults for credential and secret data. The least privilege model should be enforced and unused sensitive permissions should be revoked.

----
config from iam where source.cloud.type = 'Azure' AND source.cloud.resource.type = 'user' AND dest.cloud.service.name = 'Microsoft.KeyVault'
----


|*Azure AD user with permissions to manage Azure permissions broadly that was not used in the last 90 days*

Azure AD users with the ability to change Azure permissions through role assignments are risky permission that can lead to privilege escalation.

----
config from iam where source.cloud.type = 'Azure' AND source.cloud.resource.type = 'user' AND dest.cloud.resource.name = '*' AND action.name STARTS WITH 'Microsoft.Authorization/roleAssignments/' AND action.lastaccess.days > 90
----

|===


[#id7575e4fc-c858-46b8-a0a4-52238a2a38d2]
=== Policy Updates

[cols="50%a,50%a"]
|===
|POLICY UPDATES
|DESCRIPTION


|*Policy Updates—RQL*
|


|*AWS ElastiCache Redis with in-transit encryption disabled (Non-replication group)*

+++<draft-comment>RLP-73001</draft-comment>+++
|*Changes—* The policy RQL has been updated to report only AWS Redis resources. Due to the ingestion of Memcached clusters, the policy was listing Memcached resources along with AWS ElastiCache Redis, which did not have in-transit encryption enabled and resulted in false positive alerts.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-elasticache-cache-clusters' AND json.rule = transitEncryptionEnabled is false and replicationGroupId does not exist
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-elasticache-cache-clusters' AND json.rule = engine equals redis and transitEncryptionEnabled is false and replicationGroupId does not exist
----

*Impact—* Low. The existing alerts that were reporting for Memcached clusters are resolved with resolution status as Policy_Updated.


|*AWS RDS minor upgrades not enabled*

+++<draft-comment>RLP-75379</draft-comment>+++
|*Changes—*The policy RQL has been updated to ignore false positive alerts for AWS DocumentDB and NeptuneDB.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-rds-describe-db-instances' AND json.rule = autoMinorVersionUpgrade is false
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-rds-describe-db-instances' AND json.rule = autoMinorVersionUpgrade is false and engine does not contain docdb and engine does not contain neptune
----

*Impact—* Low. The existing alerts for AWS DocumentDB and NeptuneDB resources are resolved with resolution status as Policy_Updated.


|*AWS SNS topic policy overly permissive for publishing*

+++<draft-comment>RLP-70463</draft-comment>+++
|*Changes—* The policy RQL has been updated to ignore condition statement check in the RQL.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-sns-get-topic-attributes' AND json.rule = Policy.Statement[?any(Effect equals Allow and (Principal.AWS equals * or Principal equals *) and (Action contains SNS:Publish or Action contains sns:Publish) and Condition does not exist)] exists
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-sns-get-topic-attributes' AND json.rule = Policy.Statement[?any(Effect equals Allow and (Principal.AWS equals * or Principal equals *) and (Action contains SNS:Publish or Action contains sns:Publish) and (Condition does not exist or Condition all empty))] exists
----

*Impact—* Medium. New alerts are generated for AWS SNS topics with condition statements and Policy actions with *SNS:Publish* permissions.


|*AWS CloudFront web distribution that allow TLS versions 1.0 or lower*

+++<draft-comment>RLP-74410</draft-comment>+++
|*Changes—* The policy name, description, and RQL are updated to match latest recommended TLS version.

*Current Policy Name—* AWS CloudFront web distribution that allow TLS versions 1.0 or lower

*Updated Policy Name—* AWS CloudFront web distribution using insecure TLS version

*Updated Description—* Identifies AWS CloudFront web distributions which are configured with TLS versions for HTTPS communication between viewers and CloudFront. As a best practice, use recommended TLSv1.2_2021 as the minimum protocol version in your CloudFront distribution security policies.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-cloudfront-list-distributions' AND json.rule = 'viewerCertificate.certificateSource does not contain cloudfront and (viewerCertificate.minimumProtocolVersion equals TLSv1 or viewerCertificate.minimumProtocolVersion equals TLSv1_2016)'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-cloudfront-list-distributions' AND json.rule = viewerCertificate.certificateSource does not contain cloudfront and viewerCertificate.minimumProtocolVersion does not equal TLSv1.2_2021
----

*Impact—* Medium. New alerts are generated for AWS CloudFront where new recommended TLS version policy is not met.


|*AWS ElastiCache Redis with in-transit encryption disabled (Non-replication group)*

+++<draft-comment>RLP-73001</draft-comment>+++
|*Changes—* The policy RQL has been updated to report only AWS Redis resources. Due to the ingestion of Memcached clusters, the policy was listing Memcached resources along with AWS ElastiCache Redis, which did not have in-transit encryption enabled and resulted in false positive alerts.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-elasticache-cache-clusters' AND json.rule = transitEncryptionEnabled is false and replicationGroupId does not exist
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-elasticache-cache-clusters' AND json.rule = engine equals redis and transitEncryptionEnabled is false and replicationGroupId does not exist
----

*Impact—* Low. The existing alerts that were reporting for Memcached clusters are resolved with resolution status as Policy_Updated.


|*AWS RDS minor upgrades not enabled*


+++<draft-comment>RLP-75379</draft-comment>+++
|*Changes—* The policy RQL has been updated to ignore false positive alerts for AWS DocumentDB and NeptuneDB.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-rds-describe-db-instances' AND json.rule = autoMinorVersionUpgrade is false
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-rds-describe-db-instances' AND json.rule = autoMinorVersionUpgrade is false and engine does not contain docdb and engine does not contain neptune
----

*Impact—* Low. The existing alerts for AWS DocumentDB and NeptuneDB resources are resolved with resolution status as Policy_Updated.


|*AWS SNS topic policy overly permissive for publishing*

+++<draft-comment>RLP-70463</draft-comment>+++
|*Changes—* The policy RQL has been updated to ignore condition statement check in the RQL.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-sns-get-topic-attributes' AND json.rule = Policy.Statement[?any(Effect equals Allow and (Principal.AWS equals * or Principal equals *) and (Action contains SNS:Publish or Action contains sns:Publish) and Condition does not exist)] exists
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-sns-get-topic-attributes' AND json.rule = Policy.Statement[?any(Effect equals Allow and (Principal.AWS equals * or Principal equals *) and (Action contains SNS:Publish or Action contains sns:Publish) and (Condition does not exist or Condition all empty))] exists
----

*Impact—* Medium. New alerts are generated for AWS SNS topics with condition statements and Policy actions with *SNS:Publish* permissions.


|*AWS CloudFront web distribution that allow TLS versions 1.0 or lower*


+++<draft-comment>RLP-74410</draft-comment>+++
|*Changes—* The policy name, description, and RQL are updated to match latest recommended TLS version.

*Current Policy Name—* AWS CloudFront web distribution that allow TLS versions 1.0 or lower

*Updated Policy Name—* AWS CloudFront web distribution using insecure TLS version

*Updated Description—* Identifies AWS CloudFront web distributions which are configured with TLS versions for HTTPS communication between viewers and CloudFront. As a best practice, use recommended TLSv1.2_2021 as the minimum protocol version in your CloudFront distribution security policies.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-cloudfront-list-distributions' AND json.rule = 'viewerCertificate.certificateSource does not contain cloudfront and (viewerCertificate.minimumProtocolVersion equals TLSv1 or viewerCertificate.minimumProtocolVersion equals TLSv1_2016)'
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-cloudfront-list-distributions' AND json.rule = viewerCertificate.certificateSource does not contain cloudfront and viewerCertificate.minimumProtocolVersion does not equal TLSv1.2_2021
----

*Impact—* Medium. New alerts are generated for AWS CloudFront where new recommended TLS version policy is not met.


|*AWS ElastiCache Redis with in-transit encryption disabled (Non-replication group)*

+++<draft-comment>RLP-73001</draft-comment>+++
|*Changes—* The policy RQL has been updated to report only AWS Redis resources. Due to the ingestion of Memcached clusters, the policy was listing Memcached resources along with AWS ElastiCache Redis, which did not have in-transit encryption enabled and resulted in false positive alerts.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-elasticache-cache-clusters' AND json.rule = transitEncryptionEnabled is false and replicationGroupId does not exist
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-elasticache-cache-clusters' AND json.rule = engine equals redis and transitEncryptionEnabled is false and replicationGroupId does not exist
----

*Impact—* Low. The existing alerts that were reporting for Memcached clusters are resolved with resolution status as Policy_Updated.


|*AWS RDS minor upgrades not enabled*

+++<draft-comment>RLP-75379</draft-comment>+++
|*Changes—* The policy RQL has been updated to ignore false positive alerts for AWS DocumentDB and NeptuneDB.

*Current RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-rds-describe-db-instances' AND json.rule = autoMinorVersionUpgrade is false
----

*Updated RQL—*

----
config from cloud.resource where cloud.type = 'aws' AND api.name = 'aws-rds-describe-db-instances' AND json.rule = autoMinorVersionUpgrade is false and engine does not contain docdb and engine does not contain neptune
----

*Impact—* Low. The existing alerts for AWS DocumentDB and NeptuneDB resources are resolved with resolution status as Policy_Updated.


|*Policy Updates—Metadata*
|


|*GCP PostgreSQL instance database flag log_connections is disabled*

+++<draft-comment>RLP-72953</draft-comment>+++
|*Changes—* The policy recommendation steps have been updated to reflect the latest CSP changes.

*Impact—* No impact on existing alerts.


|*GCP Kubernetes Engine Clusters have Binary authorization disabled*

+++<draft-comment>RLP-72951</draft-comment>+++
|*Changes—* Updated policy recommendation steps to reflect the latest CSP changes.

*Impact—* No impact on existing alerts.


|*GCP Log bucket retention policy is not configured using bucket lock*

+++<draft-comment>RLP-72952</draft-comment>+++
|*Changes—* Updated policy recommendation steps to reflect the latest CSP changes.

*Impact—* No impact on existing alerts.

|===


[#idbb5b744d-bff5-451f-8fe8-5049d9adac8c]
=== Change in Existing Behavior

[cols="50%a,50%a"]
|===
|FEATURE
|DESCRIPTION


|*Region Support for Google Compute Engine*

+++<draft-comment>RLP-72327</draft-comment>+++
|Region support for *gcp-compute-disk-list* API is enabled on Prisma Cloud.

Due to this, all the resources for *gcp-compute-disk-list* are deleted once and then regenerated on the management console.

Existing alerts corresponding to these resources are resolved as *Resource_Updated*, and new alerts are generated against policy violations.

*Impact—* You may notice a reduced count for the number of alerts. However, the alert count will return to the original numbers once the resources for *gcp-compute-disk-list* start ingesting data again.

|===


[#idd803cff2-3dfe-4505-be04-06933eae8093]
=== REST API Updates

[cols="37%a,63%a"]
|===
|CHANGE
|DESCRIPTION


|*Licensing APIs*

+++<draft-comment>RLP-75002</draft-comment>+++
|The following new endpoints are available for Licensing APIs:

* userinput:[Usage Count By Cloud Type V2] - https://prisma.pan.dev/api/cloud/cspm/licensing#operation/license-usage-count-by-cloud-paginated[POST /license/api/v2/usage] - This is a new Licensing API that allows you to get paginated usage data in the response object for the selected cloud types.

* userinput:[Resource Usage Over Time V2] - https://prisma.pan.dev/api/cloud/cspm/licensing-v2#operation/license-usage-graph[POST /license/api/v2/time_series] - This is a new Licensing API that allows you to get a breakdown of resource usage over time.


|*Alert Rules APIs*

+++<draft-comment>RLP-75887</draft-comment>+++
|The following Alert Rules APIs are updated with a new filter called userinput:[Alert Rule Policy Filter] , which allows you to filter alerts based on policy severity, policy label, cloud type, and compliance standard:

*  userinput:[List Alert Rules V2] - https://prisma.pan.dev/api/cloud/cspm/alert-rules#operation/get-alert-rules-v2[GET /v2/alert/rule]
*  userinput:[Add an Alert Rule] - https://prisma.pan.dev/api/cloud/cspm/alert-rules#operation/add-alert-rule[POST /alert/rule]
*  userinput:[Get Alert Rule by ID] - https://prisma.pan.dev/api/cloud/cspm/alert-rules#operation/get-alert-rule[GET /alert/rule/{id}]
*  userinput:[Update Alert Rule] - https://prisma.pan.dev/api/cloud/cspm/alert-rules#operation/update-alert-rule[PUT /alert/rule/{id}]

|===
