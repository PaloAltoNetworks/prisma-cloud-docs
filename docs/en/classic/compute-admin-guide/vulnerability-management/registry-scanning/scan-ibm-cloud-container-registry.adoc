== Scan Images in IBM Cloud Container Registry

To scan a repository on IBM Cloud Container Registry, create a new registry scan setting.

[.task]
=== Create a new registry scan

*Prerequisites:*

* xref:../../install/deploy-defender/defender-types.adoc#[Install a Defender] somewhere in your environment.

* Set up IBM credentials with basic authentication in xref:../../authentication/credentials-store/credentials-store.adoc[Credentials store] and grant Prisma Cloud access to your repository in IBM Cloud.

** In *Account GUID*, enter the GUID for your IBM Cloud account.
See the IBM Cloud Docs to learn https://cloud.ibm.com/docs/account?topic=account-accountfaqs&interface=cli#account-details[how to get the GUID of an account]

** In *API Key*, enter your API key.
See the IBM Cloud Docs to learn how to create a service ID for Prisma Cloud, and then https://cloud.ibm.com/docs/account?topic=account-serviceidapikeys&interface=ui#create_service_key[create an API key for the service ID].

** Select *Save*. 

[.procedure]

. Go to *Defend > Vulnerabilities > Images > Registry settings*.

. Select *Add registry*.

. In the dialog, enter the following information:

.. From the *Version* drop-down list, select *IBM Cloud Container Registry*.

.. In *Registry*, enter the registry address for your
https://cloud.ibm.com/docs/Registry?topic=Registry-registry_overview#registry_regions[region].
+
For example, if you use the us-south registry, enter *us.icr.io*.

.. In *Namespace*, enter the namespace for your image.
+
For images in private registries, this field is mandatory.
For images in IBM's public registry, leave this field blank.
Wildcards are not supported for this field.
+
IBM provides
https://cloud.ibm.com/docs/Registry?topic=Registry-registry_overview#overview_elements_namespace[namespaces]
to help you organize your registries.
Namespaces are appended to the registry URL as follows: _registry.<REGION>.icr.io/<NAMESPACE>_

.. In *Repository*, enter the repository to scan.
+
If you leave this field blank or enter a wildcard, Prisma Cloud finds and scans all repositories in the registry.
+
If you specify a partial string that ends with a wildcard, Prisma Cloud finds and scans all repositories that start with the partial string.
+
If you specify an exact match, Prisma Cloud scans just the specified repository.

.. In *Tag*, enter an image tag.
+
If you leave this field blank or enter a wildcard, Prisma Cloud finds and scans all images in the repository.
+
If you specify a partial string that ends with a wildcard, Prisma Cloud finds and scans all images that match the partial tag.
+
If you specify an exact match, Prisma Cloud scans just the specified image with specified tag.

.. In *Credential*, select the credential you created for IBM Cloud.

.. In *OS type*, specify whether the repo holds *Linux* or *Windows* images.

.. In *Scanners scope*, specify the collections of defenders to use for the scan.
+
Console selects the available Defenders from the scope to execute the scan job according to the *Number of scanners* setting.
For more information, see xref:../../vulnerability-management/registry-scanning/configure-registry-scanning.adoc#deployment-patterns[deployment patterns].

.. In *Number of scanners*, enter the number of Defenders across which scan jobs can be distributed.

.. *Cap* the number of images to scan.
+
Specify the maximum number of images to scan in the given repository, sorted according to last modified date.
To scan all images in a repository, set *Cap* to 0.
For a complete explanation of *Cap*, see the table in
xref:../../vulnerability-management/registry-scanning/registry-scanning.adoc[registry scan settings].

.. Select *Add and scan*.
+
Verify that the images in the repository are being scanned under *Monitor > Vulnerabilities > Images > Registries*.
