== Azure Storage account configured with Shared Key authorization
// Ensure storage account is configured with Shared Key authorization

=== Policy Details

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| f5c4ddc4-52fc-4c52-9a60-5c40b845a683

|Checkov ID 
| https://github.com/bridgecrewio/checkov/tree/main/checkov/terraform/checks/graph_checks/azure/AzureStorageAccConfigSharedKeyAuth.yaml[CKV_AZURE_229]

|Severity
|MEDIUM

|Subtype
|Build

|Frameworks
|Terraform, Terraform Plan

|=== 

=== Description

Azure Storage accounts provide secure and highly scalable cloud data storage. Shared Key authorization is one of the methods to authenticate requests to the Azure Storage services. With Shared Key authorization, every request to a service must be signed using the account's access key.

This policy ensures that the Azure Storage account is not configured with Shared Key authorization. It checks for the presence of the `shared_access_key_enabled` attribute in the `azurerm_storage_account` resource and verifies that it's either nonexistent or set to `false`.

=== Fix - Buildtime

*Terraform*

* *Resource:* azurerm_storage_account
* *Arguments:* shared_access_key_enabled

[source,go]
----
resource "azurerm_storage_account" "example" {
  name                     = "examplestoracc"
  resource_group_name      = azurerm_resource_group.example.name
  location                 = azurerm_resource_group.example.location
  
  # ... other configurations ...

+ shared_access_key_enabled = false
}
----
