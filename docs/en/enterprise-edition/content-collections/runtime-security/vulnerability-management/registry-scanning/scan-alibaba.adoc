[#scan-alibaba]
== Scan images in Alibaba Cloud Container Registry

Configure Prisma Cloud to scan your Alibaba Cloud Container Registry.
First, create a service account, and then specify the scan parameters.


[.task]
=== Create a service account

Create a service account so Prisma Cloud can access your registry.
Prisma Cloud needs the *AliyunContainerRegistryReadOnly* permission policy to query, download, and scan the images in your registry.

[.procedure]
. In Alibaba Cloud, create a RAM account.
+
Go to *RAM > Users*, and click *Create User*.
+
image::runtime-security/scan-alibaba-create-user.png[width=600]

. Select *Add Permissions*.
+
image::runtime-security/scan-alibaba-set-perms.png[width=600]

. Search for *registry*, and then select *AliyunContainerRegistryReadOnly*.


[.task]
=== Scan images in Alibaba Cloud Container Registry

To scan a repository in Alibaba Cloud Container Registry, create a new registry scan setting.

*Prerequisites:*

* xref:../../install/deploy-defender/defender-types.adoc[Install a Defender] somewhere in your environment.
* Create an Alibaba Cloud Container Registry.
* You have the service account credentials.

[.procedure]
. Open Console, and go toÂ *Defend > Vulnerabilities > Images > Registry settings*.

. Select *Add registry*.

. In *Add New Registry Setting Specification*, enter the following values:

.. In *Version*, select *Docker Registry v2*.

.. In *Registry*, enter the Fully Qualified Domain Name (FQDN) for the registry.
For example, *registry-intl.cn-hangzhou.aliyuncs.com*.

.. In *Repository*, enter the name of the repository to scan.
Example: *library/alpine*.

.. In *Tag*, enter an image tag.
Leave this field blank to scan all images, regardless of their tag.

.. In *Credential*, configure how Prisma Cloud authenticates with Alibaba Cloud Container Registry.
+
Select a credential from the drop-down list.
If there are no credentials in the list, click *Add new*, and create a *Basic authentication* credential with the service account username and password.

.. In *OS type*, specify whether the repo holds *Linux* or *Windows* images.

.. In *Scanners scope*, specify the collections of defenders to use for the scan.
+
Console selects the available Defenders from the scope to execute the scan job according to the *Number of scanners* setting.
For more information, see xref:../../vulnerability-management/registry-scanning/configure-registry-scanning.adoc#deployment-patterns[deployment patterns].

.. In *Number of scanners*, enter the number of Defenders across which scan jobs can be distributed.

.. In *Cap*, limit the number of images to scan.
+
Set *Cap* to *5* to scan the five most recent images, or enter another value to increase or decrease the limit.
Set *Cap* to *0* to scan all images.

.. Select *Add*.

. Select *Save and scan*.
+
Verify that the images in the repository are being scanned under *Monitor > Vulnerabilities > Images > Registries*.
