[#scan-acr]
== Scan images in Azure Container Registry (ACR)

To scan a repository in Azure Container Registry (ACR), create a new registry scan setting.

[.task]
=== Create a new registry scan

*Prerequisites:*

* You have xref:../../install/deploy-defender/defender-types.adoc#[installed a Defender] somewhere in your environment.
* The Defender can establish a connection with the ACR over port 443. Ensure that the port is open for the image to be accessed successfully.
* The Azure Service Principle is assigned the *Contributor* role. xref:../../authentication/credentials-store/azure-credentials.adoc[Azure Credentials] for details.

[.procedure]

. Log in to Console, and select *Defend > Vulnerabilities > Images > Registry settings*.

. *Add registry*.

. In *Add New Registry*, enter the following values:

.. In *Version*, select *Azure Container Registry*.

.. Under *Registry*, enter the Fully Qualified Domain Name (FQDN) for the registry's ACR login server.
+
The format for the FQDN is *<REGISTRY_NAME>.azurecr.io*, where *<REGISTRY_NAME>* is a unique value specified when the registry was created.
Example: *example.azurecr.io*.

.. In *Repository*, enter the name of the repository to scan.
Example:Â *library/alpine*.

.. Enter *Tag* numbers to scan, leave blank, or enter a wildcard (*) to scan all the tags.

.. Optionally, enter *Tags to exclude*, to avoid scanning images with specified tags.

.. In *Credential*, configure how Prisma Cloud authenticates with ACR.
+
Select a credential from the drop-down list.
+
If there are no credentials in the list, click *Add new* to xref:../../authentication/credentials-store/azure-credentials.adoc[create an Azure credential] where the service principal authenticates with a password.
+
To authenticate with a certificate, xref:../../cloud-service-providers/use-cloud-accounts.adoc[create a cloud account].

.. In *OS type*, specify whether the repo holds *Linux* or *Windows* images.

.. In *Scanners scope*, specify the collections of defenders to use for the scan.
+
Console selects the available Defenders from the scope to execute the scan job according to the *Number of scanners* setting.
For more information, see xref:../../vulnerability-management/registry-scanning/configure-registry-scanning.adoc#deployment-patterns[deployment patterns].

.. In *Number of scanners*, enter the number of Defenders across which scan jobs can be distributed.

.. In *Cap*, limit the number of images to scan.
+
Set *Cap* to *5* to scan the five most recent images, or enter a different value to increase or decrease the limit.
Set *Cap* to *0* to scan all images.

.. Select *Add*.

. Select *Save and scan*.
+
Verify that the images in the repository are being xref:configure-registry-scanning.adoc[scanned] under *Monitor > Vulnerabilities > Images > Registries*.
