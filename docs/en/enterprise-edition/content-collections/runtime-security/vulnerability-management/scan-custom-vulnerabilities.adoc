[#scan-custom-vulnerabilities]
== Scan Images for Custom Vulnerabilities

Prisma Cloud lets you scan for insecure versions of proprietary software components.

First, augment the Intelligence Stream of Prisma Cloud with your custom data that specifies a package type, name, and version number.
Then configure Prisma Cloud to take action (alert or block) when the scanner finds this package in an image.
By default, Prisma Cloud raises an alert when it detects a vulnerability in a custom component.

Prisma Cloud supports the following package types:

* Distro packages (deb, rpm)
* App packages
* Nodejs packages
* Python packages
* Ruby gems
* Java artifacts (JAR files)

For cases where Prisma Cloud does not offer built-in support for a package type, you can specify an MD5 hash for the file.

[.task]
=== Add a Custom Vulnerability

Define a custom vulnerability.

[.procedure]
. Open Console.

. Go to *Manage > System > Custom Feeds > Custom Vulnerabilities*.

. Select *Add*.

.. Enter a *Name* for your vulnerability.

.. Select a package *Type*.
+
For Debian packages, RPM packages, and shared libraries, select *package*.
+
If your package type is not supported, select *app*.

.. Enter a name for your package or app.
+
Package names must be specific for matching. For example, `containerd` is valid, `containerd*` is not.

.. Specify the range of package versions for which your rule applies.
+
The following formats can be used to specify versions:
+
[cols="25%,50%,25%", options="header"]
|===
|Rule
|Format
|Example

|Specific version
|Enter a single multi-dot number.
|1.1

|Range of versions: Min and max are known.
|Enter two multi-dot numbers, separated by a dash.
|5.4-5.5

|Range of versions: Only min version is known.
|Specify a multi-dot number for the minimum version, followed by a dash, then a wild card.
|0.22.4.1-*

|Range of versions: Only max version is known.
|Specify a wild card (*) for the minimum version, followed by a dash, then a multi-dot number for the maximum version.
|*-0.22.4.1
|===
+
If package type is set to app, the version fields are not visible.
Instead, enter the MD5 hash for your file or binary.

. Select *Save*.
+
Your custom vulnerability is now available to the scanner.
+
By default, an alert is logged if an image scan detects a component that you have designated as vulnerable.
To see the default rule, go to *Defend > Vulnerabilities > Images*, and click on the *Default - alert all components* rule. To change the default rule, select a different Alert or Block threshold.
To take a different action, create a new vulnerability rule.