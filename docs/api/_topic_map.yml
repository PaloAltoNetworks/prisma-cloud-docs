#%RAML 1.0

#
# /api/v1/_ping (add_endpoints.json)
#
/_ping:
  displayName: _Ping
  description: !include ../descriptions/_ping/_ping.md

  get:
    summary: Ping
    description: !include ../descriptions/_ping/get.md

#
# /api/v1/agentless
#

/agentless:
  displayName: Overview
  description: !include ../descriptions/agentless/agentless.md

  /templates:
    post:
      summary: Download Agentless Permission Templates
      description: !include ../descriptions/agentless/post_agentless_templates.md

  /scan:
    post:
      summary: Start Agentless Scan
      description: !include ../descriptions/agentless/post_agentless_scan.md

  /progress:
    get:
      summary: View the Agentless Scan Progress 
      description: !include ../descriptions/agentless/get_agentless_progress.md

  /stop:
    post:
      summary: Stop an Ongoing Scan
      description: !include ../descriptions/agentless/post_agentless_stop.md

  
#
# /api/v1/audits
#
/audits:
  displayName: Audits
  description: !include ../descriptions/audits/audits.md

  /access:
    get:
      summary: Get Docker Access Audit Events
      description: !include ../descriptions/audits/access_get.md

  /access/download:
    get:
      summary: Download Docker Access Audit Events
      description: !include ../descriptions/audits/access_download_get.md
  
  /admission:
    get:
      summary: Get Admission Audit Events
      description: !include ../descriptions/audits/admission_get.md

  /admission/download:
    get:
      summary: Download Admission Audit Events
      description: !include ../descriptions/audits/admission_download_get.md
  
  /firewall/app/container:
    get:
      summary: Get WAAS Container Audit Events
      description: !include ../descriptions/audits/waas_container_get.md

  /firewall/app/container/download:
    get:
      summary: Download WAAS Container Audit Events
      description: !include ../descriptions/audits/waas_container_download_get.md

  /firewall/app/host:
    get:
      summary: Get WAAS Host Audit Events
      description: !include ../descriptions/audits/waas_host_get.md

  /firewall/app/host/download:
    get:
      summary: Download WAAS Host Audit Events
      description: !include ../descriptions/audits/waas_host_download_get.md

  /firewall/app/app-embedded:
    get:
      summary: Get WAAS App-embedded Audit Events
      description: !include ../descriptions/audits/waas_app_embedded_get.md

  /firewall/app/app-embedded/download:
    get:
      summary: Download WAAS App-embedded Audit Events
      description: !include ../descriptions/audits/waas_app_embedded_download_get.md

  /firewall/app/app-embedded/timeslice:
    get:
      summary: Get WAAS App-embedded Audit Events for a Timeframe
      description: !include ../descriptions/audits/waas_app_embedded_timeslice_get.md
  
  /firewall/app/serverless:
    get:
      summary: Get WAAS Serverless Audit Events
      description: !include ../descriptions/audits/waas_serverless_get.md

  /firewall/app/serverless/download:
    get:
      summary: Download WAAS Serverless Audit Events
      description: !include ../descriptions/audits/waas_serverless_download_get.md

  /firewall/app/serverless/timeslice:
    get:
      summary: Get WAAS Serverless Audit Events for a Timeframe
      description: !include ../descriptions/audits/waas_serverless_timeslice_get.md

  /firewall/app/agentless:
    get:
      summary: Get WAAS Agentless Audit Events
      description: !include ../descriptions/audits/waas_agentless_get.md

  /firewall/app/agentless/download:
    get:
      summary: Download WAAS Agentless Audit Events
      description: !include ../descriptions/audits/waas_agentless_download_get.md

  /firewall/app/agentless/timeslice:
    get:
      summary: Get WAAS Agentless Audit Events for a Timeframe
      description: !include ../descriptions/audits/waas_agentless_timeslice_get.md

  /firewall/network/container:
    get:
      summary: Get CNNS Container Audit Events
      description: !include ../descriptions/audits/firewall_network_container_get.md

  /firewall/network/container/download:
    get:
      summary: Download CNNS Container Audit Events
      description: !include ../descriptions/audits/firewall_network_container_download_get.md

  /firewall/network/host:
    get:
      summary: Get CNNS Host Audit Events
      description: !include ../descriptions/audits/firewall_network_host_get.md

  /firewall/network/host/download:
    get:
      summary: Download CNNS Host Audit Events
      description: !include ../descriptions/audits/firewall_network_host_download_get.md

  /incidents:
    get:
      summary: Get Incident Audit Events
      description: !include ../descriptions/audits/incidents_get.md

  /incidents/download:
    get:
      summary: Download Incident Audit Events
      description: !include ../descriptions/audits/incidents_download_get.md

  /incidents/acknowledge/{id}:
    patch:
      summary: Archive an Incident Audit Event
      description: !include ../descriptions/audits/incidents_archive_patch.md

  /kubernetes:
    get:
      summary: Get Kubernetes Audit Events
      description: !include ../descriptions/audits/kubernetes_get.md

  /kubernetes/download:
    get:
      summary: Download Kubernetes Audit Events
      description: !include ../descriptions/audits/kubernetes_download_get.md

  /mgmt:
    get:
      summary: Get Management Audit Events
      description: !include ../descriptions/audits/mgmt_get.md

  /mgmt/download:
    get:
      summary: Download Management Audit Events
      description: !include ../descriptions/audits/mgmt_download_get.md

  /mgmt/filters:
    get:
      summary: Get Management Audit Event Filters
      description: !include ../descriptions/audits/mgmt_filters_get.md

  /runtime/app-embedded:
    get:
      summary: Get Runtime App-embedded Audit Events
      description: !include ../descriptions/audits/runtime_app_embedded_get.md

  /runtime/app-embedded/download:
    get:
      summary: Download Runtime App-embedded Audit Events
      description: !include ../descriptions/audits/runtime_app_embedded_download_get.md
  
  /runtime/container:
    get:
      summary: Get Runtime Container Audit Events
      description: !include ../descriptions/audits/runtime_container_get.md

  /runtime/container/download:
    get:
      summary: Download Runtime Container Audit Events
      description: !include ../descriptions/audits/runtime_container_download_get.md

  /runtime/container/timeslice:
    get:
      summary: Get Runtime Container Audit Events for a Timeframe
      description: !include ../descriptions/audits/runtime_container_timeslice_get.md

  /runtime/host:
    get:
      summary: Get Runtime Host Audit Events
      description: !include ../descriptions/audits/runtime_host_get.md

  /runtime/host/download:
    get:
      summary: Download Runtime Host Audit Events
      description: !include ../descriptions/audits/runtime_host_download_get.md

  /runtime/host/timeslice:
    get:
      summary: Get Runtime Host Audit Events for a Timeframe
      description: !include ../descriptions/audits/runtime_host_timeslice_get.md

  /runtime/file-integrity:
    get:
      summary: Get Runtime File Integrity Audit Events
      description: !include ../descriptions/audits/runtime_file-integrity_get.md

  /runtime/file-integrity/download:
    get:
      summary: Download Runtime File Integrity Audit Events
      description: !include ../descriptions/audits/runtime_file-integrity_download_get.md

  /runtime/log-inspection:
    get:
      summary: Get Runtime Log Inspection Audit Events
      description: !include ../descriptions/audits/runtime_log-inspection_get.md

  /runtime/log-inspection/download:
    get:
      summary: Download Runtime Log Inspection Audit Events
      description: !include ../descriptions/audits/runtime_log-inspection_download_get.md

  /runtime/serverless:
    get:
      summary: Get Runtime Serverless Audit Events
      description: !include ../descriptions/audits/runtime_serverless_get.md

  /runtime/serverless/download:
    get:
      summary: Download Serverless Audit Events
      description: !include ../descriptions/audits/runtime_serverless_download_get.md

  /runtime/serverless/timeslice:
    get:
      summary: Get Runtime Serverless Audit Events for a Timeframe
      description: !include ../descriptions/audits/runtime_serverless_timeslice_get.md

  /trust:
    get:
      summary: Get Trust Audit Events
      description: !include ../descriptions/audits/trust_get.md

  /trust/download:
    get:
      summary: Download Trust Audit Events
      description: !include ../descriptions/audits/trust_download_get.md

#
# /api/v1/authenticate
#
/authenticate:
  displayName: User Authentication Access Token
  description: !include ../descriptions/authenticate/authenticate.md

  post:
    summary: Get User Authentication Access Token
    description: !include ../descriptions/authenticate/post.md

  /renew:
    get:
      description: !include ../descriptions/authenticate/renew_get.md

#
# /api/v1/authenticate-client
#
/authenticate-client:
  displayName: Client Authentication Access Token
  description: !include ../descriptions/authenticate-client/authenticate-client.md

  post:
    summary: Get Client Authentication Access Token
    description: !include ../descriptions/authenticate-client/post.md

#
# /api/v1/certs
#
/certs:
  displayName: Certificates
  description: !include ../descriptions/certs/certs.md

  /ca.pem:
    get:
      summary: Get CA PEM Certificate File
      description: !include ../descriptions/certs/capem_get.md
  
  /server-certs.sh:
    get:
      summary: Get Server Certificates
      description: !include ../descriptions/certs/server-certs_get.md

#
# /api/v1/cloud
#
/cloud:
  displayName: Cloud
  description: !include ../descriptions/cloud/cloud.md

  /discovery:
    get:
      summary: Get Cloud Discovery Scan Results
      description: !include ../descriptions/cloud/discovery_get.md

  /discovery/download:
    get:
      summary: Download Cloud Discovery Scan Results
      description: !include ../descriptions/cloud/discovery_download_get.md

  /discovery/entities:
    get:
      summary: Get Discovered Cloud Entities
      description: !include ../descriptions/cloud/discovery_entities_get.md

  /discovery/scan:
    post:
      summary: Start a Cloud Discovery Scan
      description: !include ../descriptions/cloud/discovery_scan_post.md

  /discovery/stop:
    post:
      summary: Stop a Cloud Discovery Scan
      description: !include ../descriptions/cloud/discovery_stop_post.md
  
  /discovery/vms:
    get:
      summary: Get Discovered VMs
      description: !include ../descriptions/cloud/discovery_vms_get.md


#
# /api/v1/coderepos-ci
#
/coderepos-vi:
  post:
      summary: Add CI Code Repo 
      description: !include ../descriptions/coderepos-ci/post.md
    
  /resolve:
    post:
      summary: Resolve Code Repos 
      description: !include ../descriptions/coderepos-ci/post_resolve.md

#
# /api/v1/collections
#
/collections:
  displayName: Collections
  description: !include ../descriptions/collections/collections.md

  get:
    summary: Get Collections
    description: !include ../descriptions/collections/get.md
  post:
    summary: Add a New Collection
    description: !include ../descriptions/collections/post.md

  /{id}:
    put:
      summary: Update an Existing Collection
      description: !include ../descriptions/collections/name_put.md
    delete:
      summary: Delete an Existing Collection
      description: !include ../descriptions/collections/name_delete.md

  /{id}/usages:
    get:
      summary: Get Policies for a Collection
      description: !include ../descriptions/collections/name_usages_get.md

#
# /api/v1/containers
#
/containers:
  displayName: Containers
  description: !include ../descriptions/containers/containers.md

  get:
    summary: Get Container Scan Results
    description: !include ../descriptions/containers/get.md

  /download:
    get:
      summary: Download Container Scan Results
      description: !include ../descriptions/containers/download_get.md

  /scan:
    post:
      summary: Start a Container Scan
      description: !include ../descriptions/containers/scan_post.md

  /names:
    get:
      summary: Get Container Names
      description: !include ../descriptions/containers/names_get.md
  
  /count:
    get:
      summary: Get Containers Count
      description: !include ../descriptions/containers/count_get.md

#
# /api/v1/credentials
#
/credentials:
  displayName: Credentials
  description: !include ../descriptions/credentials/credentials.md
  
  get:
    summary: Get All Credentials
    description: !include ../descriptions/credentials/get.md
  
  post:
    summary: Add Credentials
    description: !include ../descriptions/credentials/post.md

  /{id}:
    delete:
      summary: Delete a Credential
      description: !include ../descriptions/credentials/id_delete.md
  
  /{id}/usages:
    get:
      summary: Get Credential Usages
      description: !include ../descriptions/credentials/id_usages_get.md


#
# /api/v1/custom-compliance
#
/custom-compliance:
  displayName: Custom compliance checks
  description: !include ../descriptions/custom-compliance/custom-compliance.md

  get:
    summary: Get Custom Compliance Checks
    description: !include ../descriptions/custom-compliance/get.md
  
  put:
    summary: Update Custom Compliance Checks
    description: !include ../descriptions/custom-compliance/put.md

  /{id}:
    delete:
      summary: Delete a Custom Compliance Check
      description: !include ../descriptions/custom-compliance/id_delete.md

#
# /api/v1/custom-rules
#
/custom-rules:
  displayName: Custom rules
  description: !include ../descriptions/custom-rules/custom-rules.md
  
  get:
    summary: Get Custom Rules
    description: !include ../descriptions/custom-rules/get.md
  
  put:
    summary: Update a Custom Rule
    description: !include ../descriptions/custom-rules/put.md

  /{id}:
    delete:
      summary: Delete a Custom Rule
      description: !include ../descriptions/custom-rules/id_delete.md

#
# /api/v1/defenders
#
/defenders:
  displayName: Defenders
  description: !include ../descriptions/defenders/defenders.md
  
  get:
    summary: Get Deployed Defenders
    description: !include ../descriptions/defenders/get.md

  /app-embedded:
    post:
      summary: Generate a Docker File for App-embedded Defender
      description: !include ../descriptions/defenders/app_embedded_post.md

  /daemonset.yaml:
    post:
      summary: Generate Daemonset Deployment YAML File
      description: !include ../descriptions/defenders/daemonset_yaml_post.md
  
  /download:
    get:
      summary: Download Deployed Defenders
      description: !include ../descriptions/defenders/download_get.md
  
  /fargate.json:
    post:
      summary: Generate a Protected JSON Fargate Task Definition
      description: !include ../descriptions/defenders/fargate_json_post.md

  /fargate.yaml:
    post:
      summary: Generate a Protected YAML Fargate Task Definition
      description: !include ../descriptions/defenders/fargate_yaml_post.md

  /helm/twistlock-defender-helm.tar.gz:
    post:
      summary: Generate a Helm Deployment Chart for Defender
      description: !include ../descriptions/defenders/helm_post.md

  /image-name:
    get:
      summary: Get Docker Image Name for Defender
      description: !include ../descriptions/defenders/image-name_get.md

  /install-bundle:
    get:
      summary: Get Certificate Bundle for Defender
      description: !include ../descriptions/defenders/install-bundle_get.md

  /names:
    get:
      summary: Get Defender Names
      description: !include ../descriptions/defenders/names_get.md
  
  /serverless/bundle:
    post:
      summary: Generate Serverless Bundle for Defender
      description: !include ../descriptions/defenders/serverless-bundle_post.md

  /rasp:
    post:
      description: !include ../descriptions/defenders/rasp_post.md

  /summary:
    get:
      summary: Get Defenders Summary
      description: !include ../descriptions/defenders/summary_get.md

  /upgrade:
    post:
      summary: Upgrade Connected Single Linux Defenders
      description: !include ../descriptions/defenders/upgrade_post.md

  /{id}:
    delete:
      summary: Delete a Defender
      description: !include ../descriptions/defenders/id_delete.md

  /{id}/features:
    post:
      summary: Update Defender Configuration
      description: !include ../descriptions/defenders/id_features_post.md

  /{id}/restart:
    post:
      summary: Restart a Defender
      description: !include ../descriptions/defenders/id_restart_post.md

  /{id}/upgrade:
    post:
      summary: Upgrade a Defender
      description: !include ../descriptions/defenders/id_upgrade_post.md

#
# /api/v1/feeds
#
/feeds:
  displayName: Feeds
  description: !include ../descriptions/feeds/feeds.md

  /custom:
    /custom-vuln:
      get:
        summary: Get Custom Vulnerability Feed
        description: !include ../descriptions/feeds/custom_vuln_get.md

      put:
        summary: Update Custom Vulnerability Feed
        description: !include ../descriptions/feeds/custom_vuln_put.md
      
    /malware:
      get:
        summary: Get Custom Malware Feed
        description: !include ../descriptions/feeds/malware_get.md

      put:
        summary: Update Custom Malware Feed
        description: !include ../descriptions/feeds/malware_put.md

#
# /api/v1/groups
#
/groups:
  displayName: Groups
  description: !include ../descriptions/groups/groups.md

  get:
    summary: Get Groups
    description: !include ../descriptions/groups/get.md

  post:
    summary: Add a Group
    description: !include ../descriptions/groups/post.md

  /{id}:
    delete:
      summary: Delete a Group
      description: !include ../descriptions/groups/id_delete.md

    put:
      summary: Update a Group
      description: !include ../descriptions/groups/id_put.md

  /names:
    get:
      summary: Get Group Names
      description: !include ../descriptions/groups/names.md


#
# /api/v1/hosts
#
/hosts:
  displayName: Host scan reports
  description: !include ../descriptions/hosts/hosts.md

  get:
    summary: Get Host Scan Results
    description: !include ../descriptions/hosts/get.md

  /download:
    get:
      summary: Download Host Scan Results
      description: !include ../descriptions/hosts/download_get.md

  /scan:
    post:
      summary: Start a Host Scan
      description: !include ../descriptions/hosts/scan_post.md

  /info:
    get:
      summary: Get Host Information
      description: !include ../descriptions/hosts/info_get.md

#
# /api/v1/images
#
/images:
  displayName: Image scan reports
  description: !include ../descriptions/images/images.md

  get:
    summary: Get Image Scan Results
    description: !include ../descriptions/images/get.md

  /download:
    get:
      summary: Download Image Scan Results
      description: !include ../descriptions/images/download_get.md

  /scan:
    post:
      summary: Start Image Scan
      description: !include ../descriptions/images/scan_post.md

  /names:
    get:
      summary: Get Image Names
      description: !include ../descriptions/images/names_get.md


#
# /api/v1/policies
#
/policies:
  displayName: Policies
  description: !include ../descriptions/policies/policies.md

  /compliance/ci/serverless:
    
    get:
      summary: Get Continuous Integration (CI) Serverless Compliance Policy
      description: !include ../descriptions/policies/compliance_ci_serverless_get.md
    
    put:
      summary: Update Continuous Integration (CI) Serverless Compliance Policy
      description: !include ../descriptions/policies/compliance_ci_serverless_put.md

  /compliance/host:
    
    get:
      summary: Get Host Compliance Policy
      description: !include ../descriptions/policies/compliance_host_get.md
    
    put:
      summary: Update Host Compliance Policy
      description: !include ../descriptions/policies/compliance_host_put.md

  /compliance/serverless:
    
    get:
      summary: Get Serverless Compliance Policy
      description: !include ../descriptions/policies/compliance_serverless_get.md
    
    put:
      summary: Update Serverless Compliance Policy
      description: !include ../descriptions/policies/compliance_serverless_put.md
    
  /compliance/container:
    
    get:
      summary: Get Container Compliance Policy
      description: !include ../descriptions/policies/compliance_container_get.md
    
    put:
      summary: Update Container Compliance Policy
      description: !include ../descriptions/policies/compliance_container_put.md

  /compliance/container/impacted:
    
    get:
      summary: Get Impacted Container Compliance Policy
      description: !include ../descriptions/policies/compliance_container_impacted_get.md

  /compliance/ci/images:
    
    get:
      summary: Get Continuous Integration (CI) Image Compliance Policy
      description: !include ../descriptions/policies/compliance_ci_images_get.md
    
    put:
      summary: Update Continuous Integration (CI) Image Compliance Policy
      description: !include ../descriptions/policies/compliance_ci_images_put.md
    
  /compliance/vms:
    
    get:
      summary: Get VMs Compliance Policy
      description: !include ../descriptions/policies/compliance_vms_get.md
    
    put:
      summary: Update VMs Compliance Policy
      description: !include ../descriptions/policies/compliance_vms_put.md

  /compliance/vms/impacted:
    
    get:
      summary: Get Impacted VMs Compliance Policy
      description: !include ../descriptions/policies/compliance_vms_impacted_get.md

  /firewall/app/app-embedded:
    
    get:
      summary: Get WAAS App-embedded Policy
      description: !include ../descriptions/policies/firewall_app-embedded_get.md
    
    put:
      summary: Update WAAS App-embedded Policy
      description: !include ../descriptions/policies/firewall_app-embedded_put.md

  /firewall/app/out-of-band:
    
    get:
      summary: Get Out-of-Band WAAS Policy
      description: !include ../descriptions/policies/firewall_app_out-of-band_get.md
    
    put:
      summary: Update Out-of-Band WAAS Policy
      description: !include ../descriptions/policies/firewall_app_out-of-band_put.md

  /firewall/app/out-of-band/impacted:
    
    get:
      summary: Get Impacted Resources for Out-of-Band WAAS Policy
      description: !include ../descriptions/policies/firewall_app_out-of-band_impacted_get.md
  
  /firewall/app/container:
    
    get:
      summary: Get WAAS Container Policy 
      description: !include ../descriptions/policies/firewall_app_container_get.md
    
    put:
      summary: Update WAAS Container Policy
      description: !include ../descriptions/policies/firewall_app_container_put.md

  /firewall/app/host:
    
    get:
      summary: Get WAAS Host Policy
      description: !include ../descriptions/policies/firewall_app_host_get.md
    
    put:
      summary: Update WAAS Host Policy
      description: !include ../descriptions/policies/firewall_app_host_put.md

  /firewall/app/serverless:
    
    get:
      summary: Get WAAS Serverless Policy
      description: !include ../descriptions/policies/firewall_app_serverless_get.md
    
    put:
      summary: Update WAAS Serverless Policy
      description: !include ../descriptions/policies/firewall_app_serverless_put.md
  
  /firewall/app/rasp:
    
    get:
      description: !include ../descriptions/policies/firewall_app_rasp_get.md
    
    put:
      description: !include ../descriptions/policies/firewall_app_rasp_put.md

  /firewall/app/apispec:
    
    post:
      summary: Generate a WAAS API Specification Object 
      description: !include ../descriptions/policies/firewall_app_apispec_post.md

  /firewall/app/network-list:
    
    get:
      summary: Get WAAS Network List
      description: !include ../descriptions/policies/firewall_app_network_list_get.md
    
    put:
      summary: Update WAAS Network List
      description: !include ../descriptions/policies/firewall_app_network_list_put.md
    
    post:
      summary: Add WAAS Network List
      description: !include ../descriptions/policies/firewall_app_network_list_post.md

  /firewall/app/network-list/{id}:
    
    delete:
      summary: Delete WAAS Network List
      description: !include ../descriptions/policies/firewall_app_network_list_id_delete.md

  /firewall/network:
    
    get:
      summary: Get CNNS Container and Host Policy
      description: !include ../descriptions/policies/firewall_network_container_get.md
    
    put:
      summary: Update CNNS Container and Host Policy
      description: !include ../descriptions/policies/firewall_network_container_put.md

  /runtime/app-embedded:
    
    get:
      summary: Get Runtime App-embedded Policy
      description: !include ../descriptions/policies/runtime_app-embedded_get.md
    
    put:
      summary: Update Runtime App-embedded Policy
      description: !include ../descriptions/policies/runtime_app-embedded_put.md
    
    post:
      summary: Add Runtime App-embedded Policy
      description: !include ../descriptions/policies/runtime_app-embedded_post.md

  /runtime/container:
    
    get:
      summary: Get Runtime Container Policy
      description: !include ../descriptions/policies/runtime_container_get.md
    
    put:
      summary: Update Runtime Container Policy
      description: !include ../descriptions/policies/runtime_container_put.md
  
  /runtime/container/impacted:
    
    get:
      summary: Update Runtime Impacted Container Policy
      description: !include ../descriptions/policies/runtime_container_impacted_get.md

  /runtime/host:
    
    get:
      summary: Get Runtime Host Policy
      description: !include ../descriptions/policies/runtime_host_get.md
    
    put:
      summary: Update Runtime Host Policy
      description: !include ../descriptions/policies/runtime_host_put.md

  /runtime/serverless:
    
    get:
      summary: Get Runtime Serverless Policy
      description: !include ../descriptions/policies/runtime_serverless_get.md
    
    put:
      summary: Update Runtime Serverless Policy
      description: !include ../descriptions/policies/runtime_serverless_put.md

  /vulnerability/base-images/{id}:
    
    delete:
      summary: Delete Base Images Rule
      description: !include ../descriptions/policies/vulnerability_base_images_id_delete.md

  /vulnerability/ci/serverless:
    
    get:
      summary: Get CI Serverless Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_ci_serverless_get.md
    
    put:
      summary: Update CI Serverless Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_ci_serverless_put.md   


  /vulnerability/serverless:
    
    get:
      summary: Get Serverless Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_serverless_get.md
    
    put:
      summary: Update Serverless Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_serverless_put.md   

  /vulnerability/coderepos:
    
    get:
      summary: Get Code Repository Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_coderepos_get.md
    
    put:
      summary: Update Code Repository Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_coderepos_put.md   

  /vulnerability/coderepos/impacted:
    
    get:
      summary: Get Impacted Code Repository Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_coderepos_impacted_get.md

  /vulnerability/ci/images:
    
    get:
      summary: Get CI Image Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_ci_images_get.md
    
    put:
      summary: Update CI Image Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_ci_images_put.md   

  /vulnerability/host:
    
    get:
      summary: Get Host Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_host_get.md
    
    put:
      summary: Update Host Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_host_put.md

  /vulnerability/host/impacted:
    
    get:
      summary: Get Impacted Host Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_host_impacted_get.md

  /vulnerability/images:
    
    get:
      summary: Get Image Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_images_get.md
    
    put:
      summary: Update Image Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_images_put.md

  /vulnerability/images/impacted:
    
    get:
      summary: Get Impacted Image Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_images_impacted_get.md

  /vulnerability/vms:
    
    get:
      summary: Get VMs Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_vms_get.md
    
    put:
      summary: Update VMs Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_vms_put.md

  /vulnerability/vms/impacted:
    
    get:
      summary: Get Impacted VMs Vulnerability Policy
      description: !include ../descriptions/policies/vulnerability_vms_impacted_get.md

#
# /api/v1/profiles
#
/profiles:
  displayName: Profiles
  description: !include ../descriptions/profiles/profiles.md

  /app-embedded:
    get:
      summary: Get App-embedded Profiles
      description: !include ../descriptions/profiles/app-embedded_get.md

  /app-embedded/download:
    get:
      summary: Download App-embedded Profiles
      description: !include ../descriptions/profiles/app-embedded_download_get.md

  /container:
    get:
      summary: Get Runtime Container Profiles
      description: !include ../descriptions/profiles/container_get.md

  /container/download:
    get:
      summary: Download Runtime Container Profiles
      description: !include ../descriptions/profiles/container_download_get.md
  
  /container/learn:
    post:
      summary: Relearn Runtime Container Profiles
      description: !include ../descriptions/profiles/container_learn_post.md

  /host:
    get:
      summary: Get Runtime Host Profiles
      description: !include ../descriptions/profiles/host_get.md

  /host/download:
    get:
      summary: Download Runtime Host Profiles
      description: !include ../descriptions/profiles/host_download_get.md

#
# /api/v1/registry
#
/registry:
  displayName: Registry scan reports
  description: !include ../descriptions/registry/registry.md

  get:
    summary: Get Registry Scan Results
    description: !include ../descriptions/registry/get.md

  /download:
    get:
      summary: Download Registry Scan Results
      description: !include ../descriptions/registry/download_get.md

  /names:
    get:
      summary: Get Registry Image Names
      description: !include ../descriptions/registry/names_get.md

  /scan:
    post:
      summary: Start a Registry Scan
      description: !include ../descriptions/registry/scan_post.md

  /progress:
    get:
      summary: View Registry Scan Progress
      description: !include ../descriptions/registry/get_registry_progress.md

  /stop:
    post:
      summary: Stop a Registry Scan
      description: !include ../descriptions/registry/stop_post.md

#
# /api/v1/scans
#
/scans:
  displayName: Jenkins and twistcli scan reports
  description: !include ../descriptions/scans/scans.md

  get:
    summary: Get All CI Image Scan Results
    description: !include ../descriptions/scans/get.md

  /download:
    get:
      summary: Download CI Image Scan Results
      description: !include ../descriptions/scans/download_get.md

  /{id}:
    get:
      summary: Get CI Image Scan Results
      description: !include ../descriptions/scans/id_get.md


#
# /api/v1/serverless
#
/serverless:
  displayName: Serverless scan reports
  description: !include ../descriptions/serverless/serverless.md

  get:
    summary: Get Serverless Function Scan Results
    description: !include ../descriptions/serverless/get.md

  /download:
    get:
      summary: Download Serverless Function Scan Results
      description: !include ../descriptions/serverless/download_get.md
  
  /names:
    get:
      summary: Get Serverless Function Names
      description: !include ../descriptions/serverless/names_get.md

  /scan:
    post:
      summary: Start Serverless Function Scan
      description: !include ../descriptions/serverless/scan_post.md
  
  /stop:
    post:
      summary: Stop Serverless Function Scan
      description: !include ../descriptions/serverless/stop_post.md

#
# /api/v1/settings
#
/settings:
  displayName: Settings
  description: !include ../descriptions/settings/settings.md

  /certificates:
    post:
      summary: Add Certificate Settings for Clients Accessing a Custom CA 
      description: !include ../descriptions/settings/certificates_post.md

  /certs:
    get:
      summary: Get Certificate Settings for Prisma Cloud Compute  
      description: !include ../descriptions/settings/certs_get.md

    post:
      summary: Add Certificate Settings for Prisma Cloud Compute  
      description: !include ../descriptions/settings/certs_post.md

  /console-certificates:
    post:
      summary: Add Certificate Settings for Clients Accessing Prisma Cloud Compute
      description: !include ../descriptions/settings/certificates_post.md
  
  /coderepos:
    get:
      summary: Get Code Repository Settings 
      description: !include ../descriptions/settings/coderepos_get.md
    
    put:
      summary: Update Code Repository Settings 
      description: !include ../descriptions/settings/coderepos_put.md
  
  
  
  /custom-labels:
    get:
      summary: Get Alert Labels 
      description: !include ../descriptions/settings/custom-labels_get.md

    post:
      summary: Add Alert Labels 
      description: !include ../descriptions/settings/custom-labels_post.md
  
  /defender:
    get:
      summary: Get Advanced Defender Settings 
      description: !include ../descriptions/settings/defender_get.md

  /intelligence:
    get:
      summary: Get Intelligence Stream Settings
      description: !include ../descriptions/settings/intelligence_get.md

    post:
      summary: Add Intelligence Stream Settings
      description: !include ../descriptions/settings/intelligence_post.md

  /ldap:
    get:
      summary: Get LDAP Integration Settings
      description: !include ../descriptions/settings/ldap_get.md

    post:
      summary: Add LDAP Integration Settings
      description: !include ../descriptions/settings/ldap_post.md

  /license:
    post:
      summary: Add Prisma Cloud Compute License
      description: !include ../descriptions/settings/license_post.md

    get:
      summary: Get Prisma Cloud Compute License
      description: !include ../descriptions/settings/license_get.md

  /logging:
    get:
      summary: Get Logging Settings
      description: !include ../descriptions/settings/logging_get.md

    post:
      summary: Add Logging Settings
      description: !include ../descriptions/settings/logging_post.md

  /logon:
    get:
      summary: Get Logon Settings
      description: !include ../descriptions/settings/logon_get.md

    post:
      summary: Add Logon Settings
      description: !include ../descriptions/settings/logon_post.md

  /oauth:
    get:
      summary: Get OAuth Settings
      description: !include ../descriptions/settings/oauth_get.md

    post:
      summary: Add OAuth Settings
      description: !include ../descriptions/settings/oauth_post.md

  /oidc:
    get:
      summary: Get Open ID Connect Settings
      description: !include ../descriptions/settings/oidc_get.md

    post:
      summary: Add Open ID Connect Settings
      description: !include ../descriptions/settings/oidc_post.md

  /proxy:
    get:
      summary: Get Proxy Settings of Prisma Cloud Compute
      description: !include ../descriptions/settings/proxy_get.md

    post:
      summary: Add Proxy Settings for Prisma Cloud Compute
      description: !include ../descriptions/settings/proxy_post.md

  /registry:
    
    get:
      summary: Get Registry Settings 
      description: !include ../descriptions/settings/registry_get.md
    
    put:
      summary: Update Registry Settings 
      description: !include ../descriptions/settings/registry_put.md
    
    post:
      summary: Add Registry Settings 
      description: !include ../descriptions/settings/registry_post.md

  /saml:
    get:
      summary: Get SAML Settings of Prisma Cloud Compute
      description: !include ../descriptions/settings/saml_get.md

    post:
      summary: Add SAML Settings for Prisma Cloud Compute
      description: !include ../descriptions/settings/saml_post.md

  /scan:
    get:
      summary: Get Global Scan Settings
      description: !include ../descriptions/settings/scan_get.md

    post:
      summary: Add Global Scan Settings
      description: !include ../descriptions/settings/scan_post.md

  /serverless-scan:
    get:
      summary: Get Serverless Scan Settings
      description: !include ../descriptions/settings/serverless-scan_get.md
    post:
      summary: Add Serverless Scan Settings
      description: !include ../descriptions/settings/serverless-scan_post.md
    put:
      summary: Update Serverless Scan Settings
      description: !include ../descriptions/settings/serverless_scan_put.md

  /tas:
    get:
      summary: Get TAS Settings
      description: !include ../descriptions/settings/tas_get.md
    post:
      summary: Add TAS Settings
      description: !include ../descriptions/settings/tas_post.md

  /telemetry:
    get:
      summary: Get Telemetry Settings
      description: !include ../descriptions/settings/telemetry_get.md
    post:
      summary: Enable or Disable Telemetry Settings
      description: !include ../descriptions/settings/telemetry_post.md

  /trusted-certificate:
    post:
      summary: Add a Certificate to a Trusted Certificate List
      description: !include ../descriptions/settings/telemetry_get.md
  
  /trusted-certificates:
    post:
      summary: Add Trusted Certificate Settings
      description: !include ../descriptions/settings/telemetry_post.md
    
  /vm:
    
    get:
      summary: Get VM Image Scan Settings
      description: !include ../descriptions/settings/vm_get.md
    
    put:
      summary: Update VM Image Scan Settings
      description: !include ../descriptions/settings/vm_put.md

#
# /api/v1/signup
#
/signup:
  displayName: Signup
  description: !include ../descriptions/signup/signup.md

  post:
    summary: Create Admin Account
    description: !include ../descriptions/signup/post.md

#
# /api/v1/stats
#
/stats:
  displayName: Statistics
  description: !include ../descriptions/stats/stats.md

  /vulnerabilities/impacted-resources:
    get:
      summary: Get Impacted Resources Vulnerability (CVE) Stats
      description: !include ../descriptions/stats/vulnerabilities_impacted_resources_get.md

  /vulnerabilities/impacted-resources/download:
    get:
      summary: Download Impacted Resources Vulnerability (CVE) Stats
      description: !include ../descriptions/stats/vulnerabilities_impacted_resources_download_get.md

  /daily:
    get:
      summary: Get Daily Compliance Stats
      description: !include ../descriptions/stats/daily_get.md

  /dashboard:
    get:
      summary: Get Dashboard Stats
      description: !include ../descriptions/stats/dashboard_get.md

  /events:
    get:
      summary: Get Event Stats
      description: !include ../descriptions/stats/events_get.md

  /vulnerabilities:
    get:
      summary: Get Vulnerability (CVEs) Stats
      description: !include ../descriptions/stats/vulnerabilities_get.md

  /vulnerabilities/download:
    get:
      summary: Download Vulnerability (CVEs) Stats
      description: !include ../descriptions/stats/vulnerabilities_download_get.md

  /vulnerabilities/refresh:
    post:
      summary: Refresh Vulnerability Stats
      description: !include ../descriptions/stats/vulnerabilities_refresh_post.md

  /compliance:
    get:
      summary: Get Compliance Stats
      description: !include ../descriptions/stats/compliance_get.md

  /compliance/refresh:
    post:
      summary: Refresh Compliance Stats
      description: !include ../descriptions/stats/compliance_refresh_post.md




#
# /api/v1/statuses
#
/statuses:
  displayName: Status
  description: !include ../descriptions/statuses/statuses.md

  /registry:
    get:
      summary: Get Registry Scan Status
      description: !include ../descriptions/statuses/registry_get.md

#
# /api/v1/tags
#
/tags:
  displayName: Tags
  description: !include ../descriptions/tags/tags.md

  get:
    summary: Get Tags
    description: !include ../descriptions/tags/get.md
  
  post:
    summary: Add Tags
    description: !include ../descriptions/tags/post.md

  /{id}:
    
    put:
      summary: Update a Tag
      description: !include ../descriptions/tags/name_put.md
    
    delete:
      summary: Delete a Tag
      description: !include ../descriptions/tags/name_delete.md
    
  /{id}/vuln:
    
    post:
      summary: Set Tag Vulnerability Metadata
      description: !include ../descriptions/tags/tag_cve_post.md
    
    delete:
      summary: Delete Tag Vulnerability Metadata
      description: !include ../descriptions/tags/tag_cve_delete.md


#
# /api/v1/tas-droplets
#
/tas-droplets:
  displayName: Tanzu Application Service (TAS) Droplets

  get:
    summary: Get TAS Droplets
    description: !include ../descriptions/tas-droplets/get.md

  /download:
    get:
      summary: Download TAS Droplets
      description: !include ../descriptions/tas-droplets/download_get.md

  /scan:
    post:
      summary: Scan TAS Droplets
      description: !include ../descriptions/tas-droplets/scan_post.md

  /progress:
    get:
      summary: View TAS Droplets Scan Progress
      description: !include ../descriptions/tas-droplets/progress_get.md

  /stop:
    post:
      summary: Stop TAS Droplets Ongoing Scan
      description: !include ../descriptions/tas-droplets/stop_post.md

  /addresses:
    get:
      summary: TAS Cloud Controller Addresses
      description: !include ../descriptions/tas-droplets/get_tas_addresses.md

#
# /api/v1/trust
#
/trust:
    displayName: Trusted Repository, Image, and Registry
    description: !include ../descriptions/trust/trust.md

    /data:
      get:
        summary: Get Trusted Repository, Image, and Registry
        description: !include ../descriptions/trust/data_get.md

      put:
        summary: Update Trusted Repository, Image, and Registry
        description: !include ../descriptions/trust/data_put.md

#
# /api/v1/users
#
/users:
  displayName: Users
  description: !include ../descriptions/users/users.md

  get:
    summary: Get Users
    description: !include ../descriptions/users/get.md

  post:
    summary: Add Users
    description: !include ../descriptions/users/post.md

  put:
    summary: Update Users
    description: !include ../descriptions/users/put.md

  /password:
    put:
      summary: Update User Password
      description: !include ../descriptions/users/password_put.md

  /{id}:
    delete:
      summary: Delete Users
      description: !include ../descriptions/users/id_delete.md


#
# /api/v1/util (add_endpoints.json)
#
/util:
  displayName: Utilities
  description: !include ../descriptions/util/util.md

  /arm64/twistcli:
    get:
      summary: Download ARM64 twistcli for Linux OS
      description: !include ../descriptions/util/twistcli_arm64_get.md

  /twistcli:
    get:
      summary: Download twistcli for Linux OS
      description: !include ../descriptions/util/twistcli_get.md

  /osx/twistcli:
    get:
      summary: Download twistcli for MacOS
      description: !include ../descriptions/util/osx_twistcli_get.md

  /osx/arm64/twistcli:
    get:
      summary: Download ARM64 twistcli for MacOS
      description: !include ../descriptions/util/osx_twistcli_arm64_get.md

  /windows/twistcli.exe:
    get:
      summary: Download twistcli for Microsoft Windows
      description: !include ../descriptions/util/windows_twistcli_get.md

  /tas-tile:
    get:
      summary: Download VMware TAS Tile for Prisma Cloud Compute
      description: !include ../descriptions/util/twistlock_tas_tile_get.md

  /prisma-cloud-jenkins-plugin.hpi:
    get:
      summary: Download Jenkins Plugin for Prisma Cloud Compute
      description: !include ../descriptions/util/twistlock_jenkins_plugin_get.md


#
# /api/v1/version
#
/version:
  displayName: Version
  description: !include ../descriptions/version/version.md

  get:
    summary: Get Prisma Cloud Compute Version 
    description: !include ../descriptions/version/get.md

#
# /api/v1/vms
#
/vms:
  displayName: VM image scan reports 
  description: !include ../descriptions/vms/vms.md
  
  get:
    summary: Get VM Image Scan Results
    description: !include ../descriptions/vms/get.md

  /labels:
    get:
      summary: Get VM Image Tags
      description: !include ../descriptions/vms/labels_get.md
    
  /names:
    get:
      summary: Get VM Image Names
      description: !include ../descriptions/vms/names_get.md
    
  /download:
    get:
      summary: Download VM Image Scan Results
      description: !include ../descriptions/vms/download_get.md
    
  /scan:
    post:
      summary: Start VM Image Scan 
      description: !include ../descriptions/vms/scan_post.md
    
  /stop:
    post:
      summary: Stop VM Image Scan 
      description: !include ../descriptions/vms/stop_post.md

#
# /api/v1/waas
#
/waas:
  displayName: WAAS OpenAPI specification file scan

  /openapi-scans:
    post:
      summary: Scan OpenAPI Specification File for WAAS Observations
      description: !include ../descriptions/waas/openapi-scans_post.md
