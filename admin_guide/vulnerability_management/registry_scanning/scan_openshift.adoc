== OpenShift integrated Docker registry

Scan the OpenShift integrated Docker registry.


[.task]
=== Scan images in the OpenShift integrated Docker registry

To scan an OpenShift integrated registry, create a new registry scan setting.

*Prerequisites:*

* xref:../../install/defender_types.adoc#[Installed a Defender] somewhere in your environment.
* Obtained a https://docs.openshift.com/container-platform/3.5/rest_api/index.html#rest-api-docker-login[service account token].
* Added the cluster role permission of registry-viewer to the twistlock-service account. 
   ```oc adm policy add-cluster-role-to-user registry-viewer system:serviceaccount:<twistlock_project>:twistlock-service```

[.procedure]
. Open Console, then go to *Defend > Vulnerabilities > Registry*.

. Click *Add registry*.

. In *Version*, select *Red Hat OpenShift*.

. Enter the registry address in the *Registry* field.

. In *Repository* , specify the repository to scan.
+
If you leave this field blank or enter a wildcard, Prisma Cloud finds and scans all repositories in the registry.
+
If you specify a partial string that ends with a wildcard, Prisma Cloud finds and scans all repositories that start with the partial string.
+
If you specify an exact match, Prisma Cloud scans just the specified repository.

. Click in the *Credential* field, then click *Add new*.
+
// Specifying credentials for OpenShift's integrated registry: https://github.com/twistlock/twistlock/issues/17150

.. Select the *Basic authentication* credential type

.. In *Username*, enter any arbitrary value.

.. In *Password*, enter your service account token.

.. Save your credentials.

. In *OS type*, specify whether the repo holds *Linux* or *Windows* images.

. In *Scanners scope*, specify the collections of defenders to use for the scan.
+
Console selects the available Defenders from the scope to execute the scan job according to the *Number of scanners* setting.
For more information, see xref:../../vulnerability_management/registry_scanning.adoc#_deployment_patterns[deployment patterns].

. In *Number of scanners*, enter the number of Defenders across which scan jobs can be distributed.

. Set *Cap* to the number of most recent images to scan.
Leaving *Cap* set to *5* will scan the 5 most recent images.
Setting this field to *0* will scan all images.

. Click *Add*.

. Click the *Save* button.


[.task]
=== Results

Verify that the images in the repository are being scanned.

[.procedure]
. Go to *Monitor > Vulnerabilities > Images > Registries*.
+
A progress indicator at the top right of the window shows the status of the current scan.
As the scan of each image is completed, its findings are added to the results table.

. To get details about the vulnerabilities in an image, click on it.
+
To force a specific repository to be scanned again, select *Scan* from the top right of the results table, then click on the specific registry to rescan.
