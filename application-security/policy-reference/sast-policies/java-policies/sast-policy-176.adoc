
== Unencrypted payload with JWT

=== Policy Details

[width=45%]
[cols="1,1"]
|=== 
|Prisma Cloud Policy ID 
| TBD

|Checkov ID 
|CKV3_SAST_176

|Severity
|MEDIUM

|Subtype
|Build

|Language
|java

|CWEs
|https://cwe.mitre.org/data/definitions/327.html[CWE-327: Use of a Broken or Risky Cryptographic Algorithm]

|OWASP Categories
|https://owasp.org/Top10/A02_2021-Cryptographic_Failures/[A02:2021 - Cryptographic Failures]

|=== 

=== Description

This policy detects the use of an unencrypted payload with JSON Web Tokens (JWT). 

Vulnerable code example:

[source,java]
----
com.auth0.jwt.algorithms.Algorithm.none()
----

The above code example is vulnerable because it uses the `none()` algorithm from the `com.auth0.jwt.algorithms` package to sign the JWT payload. The `none()` algorithm does not encrypt the payload, making it susceptible to tampering and unauthorized access.

=== Fix - Buildtime

To fix this issue, you should use a cryptographically secure algorithm to encrypt the JWT payload.

Secure code example:

[source,java]
----
com.auth0.jwt.algorithms.Algorithm.HMAC256("secret")
----

In the secure code example, the `HMAC256` algorithm is used to encrypt the JWT payload with a secret key. This adds a layer of security to the token and ensures that the payload cannot be tampered with or accessed by unauthorized parties.
    