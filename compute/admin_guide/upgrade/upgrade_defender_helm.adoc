:topic_type: task

[.task]
== Upgrade Defender DaemonSets (Helm)

Generate an updated Helm chart for the Defender DaemonSet, and then upgrade to it.

NOTE: The value for "--address" Can be found at Compute > Manage > System > Utilities > "Path to Console" .
The value for "--cluster-address" will be only the region, with .cloud.twistlock.com appended.
Example command for the app4, us-west1 stack:
./twistcli defender export kubernetes \
    --address https://us-west1.cloud.twistlock.com/us-4-xxxxxx \
    --user serviceAccountUsername \
    --cluster-address us-west1.cloud.twistlock.com \
    --helm
For Prisma Cloud Enterprise Edition, your user should be either an access key, or service account username.

[.procedure]
. Create an updated Defender DaemonSet Helm chart.

  $ ./twistcli defender export kubernetes \
    --address <PATH_TO_CONSOLE> \
    --user <ADMIN_USER> \
    --cluster-address <REGION_CODE>.cloud.twistlock.com \
    --helm

. Install the updated chart.

  $ helm upgrade twistlock-defender-ds \
    --namespace twistlock \
    --recreate-pods
    ./twistlock-defender-helm.tar.gz
