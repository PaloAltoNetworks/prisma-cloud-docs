== Scan images in Alibaba Cloud Container Registry

Configure Prisma Cloud to scan your Alibaba Cloud Container Registry.
First, create a service account, and then specify the scan parameters.


[.task]
=== Create a service account

Create a service account so Prisma Cloud can access your registry.
Prisma Cloud needs the *AliyunContainerRegistryReadOnly* permission policy to query, download, and scan the images in your registry.

[.procedure]
. In Alibaba Cloud, create a RAM account.
+
Go to *RAM > Users*, and click *Create User*.
+
image::scan_alibaba_create_user.png[width=600]

. Click *Add Permissions*.
+
image::scan_alibaba_set_perms.png[width=600]

. Search for *registry*, and then select *AliyunContainerRegistryReadOnly*.


[.task]
=== Scan images in Alibaba Cloud Container Registry

To scan a repository in Alibaba Cloud Container Registry, create a new registry scan setting.

*Prerequisites:*

* You've xref:../../install/defender_types.adoc[installed a Container Defender] somewhere in your environment.
* You've already created an Alibaba Cloud Container Registry.
* You have the service account credentials.

[.procedure]
. Open Console, and go to *Defend > Vulnerabilities > Registry*. 

. Click *Add registry*.

. In the *Add New Registry Setting Specification* dialog, enter the following values:

.. In the *Version* drop-down list, select *Docker Registry v2*.

.. In the *Registry* field, enter the Fully Qualified Domain Name (FQDN) for the registry.
For example, *registry-intl.cn-hangzhou.aliyuncs.com*.

.. In the *Repository* field, enter the name of the repository to scan.
Example: *library/alpine*.

.. In the *Tag* field, enter an image tag.
Leave this field blank to scan all images, regardless of their tag.

.. In the *Credential* field, configure how Prisma Cloud authenticates with Alibaba Cloud Container Registry.
+
Select a credential from the drop-down list.
If there are no credentials in the list, click *Add new*, and create a *Basic authentication* credential with the service account username and password.

.. In the *OS type* field, specify whether the repo holds *Linux* or *Windows* images.

.. In *Scanners scope*, specify the collections of defenders to use for the scan.
+
Console selects the available Defenders from the scope to execute the scan job according to the *Number of scanners* setting.
For more information, see xref:../../vulnerability_management/registry_scanning.adoc#_deployment_patterns[deployment patterns].

.. In *Number of scanners*, enter the number of Defenders across which scan jobs can be distributed.

.. In *Cap*, limit the number of images to scan.
+
Set *Cap* to *5* to scan the five most recent images, or enter another value to increase or decrease the limit.
Set *Cap* to *0* to scan all images.

.. Click *Add*.

. Click the *Save* button.


[.task]
=== Results

Verify that the images in the repository are being scanned.

[.procedure]
. Go to *Monitor > Vulnerabilities > Images > Registries*.
+
A progress indicator at the top right of the window shows the status of the current scan.
As the scan of each image is completed, its findings are added to the results table.

. To get details about the vulnerabilities in an image, click on it.
+
To force a specific repository to be scanned again, select *Scan* from the top right of the results table, then click on the specific registry to rescan.
