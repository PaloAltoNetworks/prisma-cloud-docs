== Scan images in Azure Container Registry (ACR)

To scan a repository in Azure Container Registry (ACR), create a new registry scan setting.

[.task]
=== Create a new registry scan

[.procedure]

. Prerequisites
.. You have xref:../../install/defender_types.adoc#[installed a Defender] somewhere in your environment. 
.. The Defender can establish a connection with the ACR over port 443.
+
Ensure that the port is open for the image to be accessed successfully.

. Log in to Console, and select *Defend > Vulnerabilities > Registry*. 

. *Add registry*.

. In the *Add New Registry Setting Specification* dialog, enter the following values:

.. In the *Version* drop-down list, select *Azure Container Registry*.

.. In the *Registry* field, enter the Fully Qualified Domain Name (FQDN) for the registry’s ACR login server.
+
The format for the FQDN is *<REGISTRY_NAME>.azurecr.io*, where *<REGISTRY_NAME>* is a unique value specified when the registry was created.
Example: *example.azurecr.io*.

.. In the *Repository* field, enter the name of the repository to scan.
Example: *library/alpine*.

.. In the *Tag* field, enter an image tag.
Leave this field blank to scan all images, regardless of their tag.

.. In the *Credential* field, configure how Prisma Cloud authenticates with ACR.
+
Select a credential from the drop-down list.
+
If there are no credentials in the list, click *Add new* to xref:../../authentication/credentials_store.adoc#_azure_service_principal[create an Azure credential] where the service principal authenticates with a password.
+
To authenticate with a certificate, xref:../../authentication/cloud_accounts.adoc[create a cloud account].

.. In the *OS type* field, specify whether the repo holds *Linux* or *Windows* images. 

.. In *Scanners scope*, specify the collections of defenders to use for the scan.
+
Console selects the available Defenders from the scope to execute the scan job according to the *Number of scanners* setting.
For more information, see xref:../../vulnerability_management/registry_scanning.adoc#_deployment_patterns[deployment patterns].

.. In *Number of scanners*, enter the number of Defenders across which scan jobs can be distributed.

.. In *Cap*, limit the number of images to scan.
+
Set *Cap* to *5* to scan the five most recent images, or enter a different value to increase or decrease the limit.
Set *Cap* to *0* to scan all images.

.. Click *Add*.

. Click the *Save* button.


[.task]
=== Results

Verify that the images in the repository are being scanned.

[.procedure]
. Go to *Monitor > Vulnerabilities > Images > Registries*.
+
A progress indicator at the top right of the window shows the status of the current scan.
As the scan of each image is completed, its findings are added to the results table.

. To get details about the vulnerabilities in an image, click on it.
+
To force a specific repository to be scanned again, select *Scan* from the top right of the results table, then click on the specific registry to rescan.
