== Agentless scanning

Agentless scanning lets you inspect the risks and vulnerabilities of a virtual machine without having to install an agent or affecting the execution of the instance.
Prisma Cloud gives you the flexibility to choose between agentless and agent-based security using Defenders.
Currently, Prisma Cloud supports agentless scanning on AWS, GCP and Azure hosts for vulnerabilities and compliance.
Agentless capabilities will continue to be enhanced over future releases in parallel with Defender capabilities.

Continue reading this page to learn about the Agentless Scanning architecture and results. 
To configure Agentless Scanning for your accounts, follow the https://docs.paloaltonetworks.com/prisma/prisma-cloud/22-06/prisma-cloud-compute-edition-admin/configure/configure-agentless-scanning[step-by-step instructions].

=== Architecture

There are two ways you can set up agentless scanning with Prisma Cloud.

* Scan all hosts of a cloud account within the same cloud account, or
* Scan all hosts of a cloud account, called _target account_, from another dedicated cloud account, called _hub account_. 

[NOTE]
====
Agentless scanning isn't supported for xref:../install/system_requirements.adoc[hosts running Windows].
====

*Option 1: Scan within the same account*

. https://docs.paloaltonetworks.com/prisma/prisma-cloud/22-06/prisma-cloud-compute-edition-admin/configure/configure-agentless-scanning[Onboard cloud accounts] inside Prisma Cloud Compute with specific permissions required for agentless setup. 
. Prisma Cloud lists instances in each account and creates snapshots for each instance.
. Prisma Cloud starts spot instances, called _scanners_, within the same account, attaches snapshots, and performs the analysis.
. Scanners send results to the Prisma Cloud Console.
. Scanners and snapshots created by Prisma Cloud are deleted.
. Process repeats for periodic scans.

*Option 2: Scan within a dedicated cloud account*

. Onboard accounts with different permissions for hub account, which perform the scan, and target accounts, which the hub account scans. Follow the step-by-step instructions to https://docs.paloaltonetworks.com/prisma/prisma-cloud/22-06/prisma-cloud-compute-edition-admin/configure/configure-agentless-scanning[configure the permissions].  
. Prisma Cloud only spins up scanners in the dedicated hub account and attaches snapshots of instances from other accounts to the scanners in the hub account. 
. Scanners send results to the Prisma Cloud Console
. Scanners then get deleted along with the snapshots that Prisma Cloud creates.
. Process repeats for periodic scans.

=== Results

Agentless scan results are cohesively integrated with Defender results throughout the Console with no separate API calls or dashboards to provide seamless experience regardless of underlying architecture.

Agentless scans provide - 

* Host vulnerabilities scans
* Host Compliance and https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/compliance/custom_compliance_checks[custom compliance] scans
* Unscanned region detection with Cloud Discovery integration
* Pending OS security updates 

==== Vulnerability scans

Navigate to *Monitor > Vulnerabilities > Hosts* to view agentless vulnerability scan results.
You can see a column named *Scanned by* in the results page.
On the rows where entry is *Agentless*, scan results are provided by agentless scanning. 

Agentless scans provide risk factors associated with each vulnerability such as package in use, exposed to internet, etc. (https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/compliance/compliance_explorer[here]).
You can add tags and create policies in alert mode for exceptions.
Agentless scanning is integrated with Vulnerability Explorer and Host Radar. 

image::agentless_results.png[width=800]

==== Compliance scans

Navigate to *Monitor > Compliance > Hosts* to view agentless compliance scan results.
You can see a column named *Scanned by* in the results page.
On the rows where entry is *Agentless*, scan results are provided by agentless scanning. 

image::agentless_compex.png[width=800]

Agentless scans provide risk factors associated with each compliance issue and overall compliance rate for host benchmarks. (learn more https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/vulnerability_management/vuln_explorer[here]).
You can add tags and create policies in alert mode for exceptions.
Agentless scanning is integrated with Compliance Explorer and Host Radar. 

==== Custom Compliance scans

You can create custom compliance checks on file systems for your host and add them to your compliance policy for scanning. 
https://docs.paloaltonetworks.com/prisma/prisma-cloud/prisma-cloud-admin-compute/compliance/custom_compliance_checks[Follow the instructions] to enable custom compliance checks in a single step for both Defenders and Agentless scans. 

==== Pending OS updates

Unpatched OSes lead to security risks and greater possibility of exploits. 
Through agentless scanning, find pending OS security updates as a compliance check.

image::agentless_pendingOS.png[width=800]

You can search for all hosts with pending OS updates by searching for "Ensure no pending OS updates" string in Compliance explorer page (Monitor > Compliance > Compliance eExplorer tab).

*Syntax:*
 <package name> [<current version>] (<new version available> â€¦)

==== Cloud Discovery Integration

When cloud discovery is enabled, agentless scans are automatically integrated with the results to provide visibility into all regions and cloud accounts where agentless scanning is not enabled along with undefended hosts. 

image::agentless_cloud.png[width=800]

==== Pre-flight checks 

Before scanning, Prisma Cloud performs pre-flight checks and shows any missing permissions.
You can see the status of the credentials without waiting for the scan to fail.
This gives you proactive visibility into errors and missing permissions allowing you to fix them to ensure successful scans.
The following image shows the notification of a missing permission.

image::agentless_preflight.png[width=800]

*Scan Settings:*
Periodic scans occur every 24 hours by default.
You can change the scan interval under *Manage - System > Scan - Agentless* setting.
You can also perform on-demand scans by clicking the *Agentless scan* button on any of the Monitor pages or by selecting specific accounts under *Manage > Cloud accounts > Scan button* for bulk scanning.

=== Next Steps

Start scanning your AWS, Azure and GCP accounts for vulnerabilities and configuration risks with Agentless Scanning. 
Follow the instructions in https://docs.paloaltonetworks.com/prisma/prisma-cloud/22-06/prisma-cloud-compute-edition-admin/configure/configure-agentless-scanning[Configure Agentless scanning document].
