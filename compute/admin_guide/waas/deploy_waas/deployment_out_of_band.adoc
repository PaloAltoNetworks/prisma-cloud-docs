== Deploy WAAS Out-Of-Band

Out-Of-Band WAAS rules inspect HTTP requests and responses through a mirror of the traffic to provide WAAS detections to Prisma Cloud Compute Defenders without additional configurations.

In Out-Of-Band mode, WAAS does not proxy traffic to or from the protected application and all the detections are applied on a read-only copy of the traffic. 
As a result, there is no risk of interfering with the application flow.

You can use the TLS protocol (1.0, 1.1, 1.2) over HTTP/1.1 with the following RSA Key Exchange cipher suites to protect the API endpoints:

* TLS_RSA_WITH_AES_128_GCM_SHA256
* TLS_RSA_WITH_AES_256_GCM_SHA384
* TLS_RSA_WITH_AES_128_CBC_SHA256
* TLS_RSA_WITH_AES_128_CBC_SHA
* TLS_RSA_WITH_AES_256_CBC_SHA
* TLS_RSA_WITH_3DES_EDE_CBC_SHA
* TLS_RSA_WITH_RC4_128_SHA

The full handshake process must be captured as partial transmission or session resumption process inspection are not (or cannot be) decrypted.
WAAS Out-Of-Band for hosts is only supported for Linux OS and not for Windows OS.

=== Prerequisites

* You have xref:../../install/defender_types.adoc#[installed a Container Defender] in your workload environment.
* The minimum version of Console and Defender is 22.12. 
* A TLS certificate in PEM format.

[.task]
=== Create a WAAS rule for Out-Of-Band network traffic

To deploy WAAS for Out-Of-Band network traffic, create a new rule, define application endpoints, and select protections.

[.procedure]
. Open Console, and go to *Defend > WAAS > [Container|Host] > Out-Of-Band*.

. Click *Add rule*.

. Enter a *Rule Name* and *Notes* (Optional) for describing the rule.

. Choose the rule *Scope* by specifying the resource collection(s) to which it applies.
+
image::waas_select_scope.png[scale=20]
+
Collections define a combination of image names and one or more elements to which WAAS should attach itself to protect the web application:
+
image::waas_define_collection.png[scale=20]
+
NOTE: Applying a rule to all images using a wild card (`*`) is invalid - instead, only specify your web application images.

. (Optional) Enable *API endpoint discovery*
+
When enabled, the Defender inspects the API traffic to and from the protected API.
Defender reports a list of the endpoints and their resource path in *Compute > Monitor > WAAS > API discovery*.

. (Optional) Enable *Automatically detect ports* for an endpoint to deploy the WAAS's protection on ports identified in the unprotected web apps report in *Monitor > WAAS > Unprotected web apps* for each of the workloads in the rule scope.
+
NOTE: As an additional measure, you can specify additional ports by specifying them in the protected HTTP endpoints within each app to also include the ports that may not have been detected automatically.
+
NOTE: By enabling both *Automatically detect ports* and *API endpoint discovery*, you can monitor your API endpoints and ports without having to add an application and without configuring any policies. 

. *Save* the rule.

=== Add an App (policy) to the rule
:waas_oob:
include::fragments/add-app-policy.adoc[leveloffset=0]

[#actions]
=== WAAS Actions for Out-Of-Band traffic

The following actions are applicable for the HTTP requests or responses related to the *Out-Of-Band traffic*:

* *Alert* - An audit is generated for visibility.

* *Disable* - The WAAS action is disabled.

=== Troubleshooting

*No inspection generated by WAAS Out-Of-Band for TLS protocol*

Ensure that the requests use a supported TLS protocol and cipher suite, and respect the limitations listed in the Limitations section.
