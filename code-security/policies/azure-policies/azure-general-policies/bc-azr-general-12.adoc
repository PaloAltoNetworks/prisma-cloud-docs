== SQL servers audit logs retention period less than 90 days 


=== Description 


Audit Logs can help you find suspicious events, unusual activity, and trends.
Auditing the SQL server, at the server-level, allows you to track all existing and newly created databases on the instance.
This policy identifies SQL servers which do not retain audit logs for more than 90 days.
As a best practice, configure the audit logs retention time period to be greater than 90 days
////
=== Fix - Runtime

. Log in to the Azure Portal.

. Select 'SQL servers'.

. Select the SQL server instance you want to modify.

. Select 'Auditing', and verify that 'Auditing' is 'On'.

. Select 'Storage Details' and select the 'Storage account' in which to save the logs.

. Set the 'Retention (days)' to 0 (indefinite) or greater than 90 days.

. Select 'OK' and 'Save' your changes."
////
=== Fix - Buildtime


*Terraform* 


Resource: azurerm_mssql_database_extended_auditing_policy Attribute: retention_in_days


[source,go]
----
{
  "codes": [
    {
      "code": "resource "azurerm_mssql_database_extended_auditing_policy" "example" {
  ...
  retention_in_days                       = 95 # any value above ninety 
}",
      "language": "go"
    }
  ]
}
----
