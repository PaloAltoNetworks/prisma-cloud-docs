== core/workflow

=== Recipe

Defines a list of steps that make up a workflow.

==== Example

[source,json]
----
{
  "deploymentMode": "Unrestricted",
  "label": "magicpanda",
  "name": "the name",
  "propagate": false,
  "protected": false,
  "targetIdentities": [
    "processingunit",
    "enforcer"
  ]
}
----

==== Relations

===== `GET /recipes`

Retrieves the list of recipes.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.
* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `POST /recipes`

Creates a new recipe.

===== `DELETE /recipes/:id`

Deletes the recipe with the given ID.

Parameters:

* `q` (`string`): Filtering query. Consequent `q` parameters will form
an or.

===== `GET /recipes/:id`

Retrieves the recipe with the given ID.

Parameters:

* `propagated` (`boolean`): Also retrieve the objects that propagate
down.

===== `PUT /recipes/:id`

Updates the recipe with the given ID.

===== `GET /recipes/:id/importreferences`

Returns the list of import references that depend on a recipe.

===== `POST /recipes/:id/importreferences`

Create an import request for the given recipe.

==== Attributes

===== `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

Identifier of the object.

===== `annotations`

Type: `map[string][]string`

Stores additional information about an entity.

===== `associatedTags`

Type: `[]string`

List of tags attached to an entity.

===== `createTime` [`autogenerated`,`read_only`]

Type: `time`

Creation date of the object.

===== `deploymentMode`

Type: `enum(Unrestricted | Unique | NamespaceUnique)`

Defines the deployment mode of the recipe. If Unrestricted, recipe can
be deployed multiple times in the current namespace and below. If
Unique, only one deployment is allowed in the current namespace and its
child namespaces. If NamespaceUnique, only one deployment is allowed in
the current namespace.

Default value:

[source,json]
----
"Unrestricted"
----

===== `description` [`max_length=1024`]

Type: `string`

Description of the object.

===== `icon`

Type: `string`

Contains a base64-encoded image for the recipe.

===== `key` [`read_only`]

Type: `string`

The unique key of the recipe.

===== `label` [`required`,`creation_only`]

Type: `string`

Defines the recipe.

Default value:

[source,json]
----
"magicpanda"
----

===== `longDescription`

Type: `string`

Provides a long description of the recipe.

===== `metadata` [`creation_only`]

Type: `[]string`

Contains tags that can only be set during creation, must all start with
the `@' prefix, and should only be used by external systems.

===== `name` [`required`,`max_length=256`]

Type: `string`

Name of the entity.

===== `namespace` [`autogenerated`,`read_only`]

Type: `string`

Namespace tag attached to an entity.

===== `normalizedTags` [`autogenerated`,`read_only`]

Type: `[]string`

Contains the list of normalized tags of the entities.

===== `options`

Type: link:#recipeoptions[`recipeoptions`]

Options of the recipe.

===== `propagate`

Type: `boolean`

Propagates the policy to all of its children.

===== `protected`

Type: `boolean`

Defines if the object is protected.

===== `steps`

Type: link:#uistep[`uistep`]

Contains all the steps with parameters to follow for the recipe.

===== `successfullMessage`

Type: `string`

A string message presented upon success (optional).

===== `targetIdentities` [`required`]

Type: `[]string`

Contains the list of identities the recipes will try to create.

===== `template`

Type: `string`

Template of the recipe to import.

===== `templateHash` [`read_only`]

Type: `string`

A hash of the template.

===== `updateTime` [`autogenerated`,`read_only`]

Type: `time`

Last update date of the object.

=== RecipeOptions

Represents recipe options.

==== Example

[source,json]
----
{
  "appCrendentialFormat": "JSON"
}
----

==== Attributes

===== `appCrendentialFormat`

Type: `enum(JSON | YAML)`

Indicates the format of the app credential.

Default value:

[source,json]
----
"JSON"
----

=== RenderTemplate

Cooks a template based some parameters.

==== Relations

===== `POST /rendertemplates`

Renders a new template.

==== Attributes

===== `output`

Type: `string`

Holds the rendered template.

===== `parameters`

Type: `map[string]interface{}`

Contains the computed parameters.

===== `template`

Type: `string`

Template of the recipe.

=== UIParameter

Represents a parameter that will be shown in the web interface.

==== Example

[source,json]
----
{
  "advanced": false,
  "key": "unique_key",
  "optional": false,
  "type": "String",
  "width": "100%"
}
----

==== Attributes

===== `advanced`

Type: `boolean`

A value of `true` designates the parameter as advanced.

===== `allowedChoices`

Type: `map[string]string`

Lists all the choices in case of an enum.

===== `allowedValues`

Type: `[]object`

List of values that can be used.

===== `defaultValue`

Type: `object`

Default value of the parameter.

===== `description`

Type: `string`

Description of the parameter.

===== `key` [`required`]

Type: `string`

Key identifying the parameter.

===== `longDescription`

Type: `string`

Long explanation of the parameter.

===== `name`

Type: `string`

Name of the parameter.

===== `optional`

Type: `boolean`

A value of `true` designates the parameter as optional.

===== `subtype`

Type: `string`

The subtype of a list parameter.

===== `type` [`required`]

Type:
`enum(Boolean | Checkbox | CVSSThreshold | DangerMessage | Duration | Enum | Endpoint | FileDrop | Float | FloatSlice | InfoMessage | Integer | IntegerSlice | JSON | List | Message | Namespace | Password | String | StringSlice | Switch | TagsExpression | Title | WarningMessage)`

The datatype of the parameter.

===== `validationFunction`

Type: `string`

A function that validates the parameter.

===== `value`

_This attribute is deprecated_.

Type: `object`

Value of the parameter.

===== `visibilityCondition`

Type: `uiparametersexpression`

A logical expression consisting of one or more
link:#uiparametervisibility[UIParameterVisibility] conditions linked
together using AND or OR operators. If the expression evaluates to true
the parameter is displayed to the user.

===== `width`

Type: `string`

Width of the parameter.

Default value:

[source,json]
----
"100%"
----

=== UIParameterVisibility

Represents a visibility condition for a link:#uiparameter[UIParameter].

==== Example

[source,json]
----
{
  "key": "enableThing",
  "operator": "Equal",
  "value": true
}
----

==== Attributes

===== `key` [`required`]

Type: `string`

Key holding the value to compare.

===== `operator`

Type:
`enum(Equal | NotEqual | GreaterThan | LesserThan | Defined | Undefined | Match | NotMatch)`

Operator to apply.

===== `value` [`required`]

Type: `object`

Values that must match the key.

=== UIStep

Represents a step that will be shown in the web interface.

==== Example

[source,json]
----
{
  "advanced": false,
  "name": "General configuration"
}
----

==== Attributes

===== `advanced`

Type: `boolean`

Defines if the step is an advanced one.

===== `description`

Type: `string`

Description of the step.

===== `name` [`required`]

Type: `string`

Name of the step.

===== `parameters`

Type: link:#uiparameter[`uiparameter`]

List of parameters for this step.

=== ValidateUIParameter

Validates a list of link:#uiparameter[UIParameter] parameters.

==== Relations

===== `POST /validateuiparameters`

Validates some UI parameters.

==== Attributes

===== `errors`

Type: `map[string]string`

Contains the list of errors.

===== `parameters`

Type: link:#uiparameter[`uiparameter`]

List of parameters to validate.

===== `values`

Type: `map[string]interface{}`

Contains the computed values.
